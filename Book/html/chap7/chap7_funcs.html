<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>7. Functions &mdash; PyMan 0.9.31 documentation</title>
    
    <link rel="stylesheet" href="../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.31',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="PyMan 0.9.31 documentation" href="../index.html" />
    <link rel="next" title="8. Curve Fitting" href="../chap8/chap8_fitting.html" />
    <link rel="prev" title="6. Conditionals and Loops" href="../chap6/chap6_loopsconds.html" /> 
  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
        <div class="headertitle"><a
          href="../pymanMaster.html">PyMan 0.9.31 documentation</a></div>
        <div class="rel">
          <a href="../chap6/chap6_loopsconds.html" title="6. Conditionals and Loops"
             accesskey="P">previous</a> |
          <a href="../chap8/chap8_fitting.html" title="8. Curve Fitting"
             accesskey="N">next</a> |
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="functions">
<span id="chap7"></span><h1>7. Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h1>
<p>As you develop more complex computer code, it becomes increasingly important to organize your code into modular blocks.  One important means for doing so is  <em>user-defined</em> Python functions.  User-defined functions are a lot like built-in functions that we have encountered in core Python as well as in NumPy and Matplotlib.  The main difference is that user-defined functions are written by you.  The idea is to define functions to simplify your code and to allow you to reuse the same code in different contexts.</p>
<p>The number of ways that functions are used in programming is so varied that we cannot possibly enumerate all the possibilities.  As our use of Python functions in scientific program is somewhat specialized, we introduce only a few of the possible uses of Python functions, ones that are the most common in scientific programming.</p>
<div class="section" id="user-defined-functions">
<span id="userdefdfuncs"></span><span id="index-0"></span><h2>7.1. User-defined functions<a class="headerlink" href="#user-defined-functions" title="Permalink to this headline">¶</a></h2>
<p>The NumPy package contains a plethora of mathematical functions.  You can find a listing of the mathematical functions available through NumPy on the web page <a class="reference external" href="http://docs.scipy.org/doc/numpy/reference/routines.math.html">http://docs.scipy.org/doc/numpy/reference/routines.math.html</a>.  While the list may seem pretty exhaustive, you may nevertheless find that you need a function that is not available in the NumPy Python library.  In those cases, you will want to write your own function.</p>
<p>In studies of optics and signal processing one often runs into the sinc function, which is defined as</p>
<div class="math">
<p><img src="../_images/math/56af027d32b617d88ce0a0ce5317622ccd02de1f.png" alt="\mathrm{sinc}\,x \equiv \frac{\sin x}{x} \;."/></p>
</div><p>Let&#8217;s write a Python function for the sinc function.  Here is our first attempt:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">sinc</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span>
    <span class="k">return</span> <span class="n">y</span>
</pre></div>
</div>
<p>Every function definition begins with the word <tt class="docutils literal"><span class="pre">def</span></tt> followed by the name you want to give to the function, <tt class="docutils literal"><span class="pre">sinc</span></tt> in this case, then a list of arguments enclosed in parentheses, and finally terminated with a colon.  In this case there is only one argument, <tt class="docutils literal"><span class="pre">x</span></tt>, but in general there can be as many arguments as you want, including no arguments at all.  For the moment, we will consider just the case of a single argument.</p>
<p>The indented block of code following the first line defines what the function does.  In this case, the first line calculates <img class="math" src="../_images/math/2c836fa0289688e48f907c85ba463ca4b4dbfd81.png" alt="\mathrm{sinc}\,x = \sin x/x"/> and sets it equal to <tt class="docutils literal"><span class="pre">y</span></tt>.  The <tt class="docutils literal"><span class="pre">return</span></tt> statement of the last line tells Python to return the value of <tt class="docutils literal"><span class="pre">y</span></tt> to the user.</p>
<p>We can try it out in the IPython shell.  First we type in the function definition.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="k">def</span> <span class="nf">sinc</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">   ...:</span>     <span class="n">y</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span>
<span class="gp">   ...:</span>     <span class="k">return</span> <span class="n">y</span>
</pre></div>
</div>
<p>Because we are doing this from the IPython shell, we don&#8217;t need to import NumPy; it&#8217;s preloaded.  Now the function <img class="math" src="../_images/math/5db5939f2972aee19dd2afe3e2a5a6e2e5f8f9af.png" alt="\mathrm{sinc}\,x"/> is available to be used from the IPython shell</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [2]: </span><span class="n">sinc</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gr">Out[2]: </span><span class="o">-</span><span class="mf">0.18920062382698205</span>

<span class="gp">In [3]: </span><span class="n">a</span> <span class="o">=</span> <span class="n">sinc</span><span class="p">(</span><span class="mf">1.2</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">a</span>
<span class="gr">Out[4]: </span><span class="mf">0.77669923830602194</span>

<span class="gp">In [5]: </span><span class="n">sin</span><span class="p">(</span><span class="mf">1.2</span><span class="p">)</span><span class="o">/</span><span class="mf">1.2</span>
<span class="gr">Out[5]: </span><span class="mf">0.77669923830602194</span>
</pre></div>
</div>
<p>Inputs and outputs 4 and 5 verify that the function does indeed give the same result as an explicit calculation of <img class="math" src="../_images/math/ab3c93971bc9d609ddd7a756f07a96f64fdf0ac3.png" alt="\sin x/x"/>.</p>
<p>You may have noticed that there is a problem with our definition of <img class="math" src="../_images/math/5db5939f2972aee19dd2afe3e2a5a6e2e5f8f9af.png" alt="\mathrm{sinc}\,x"/> when <tt class="docutils literal"><span class="pre">x=0.0</span></tt>.  Let&#8217;s try it out and see what happens</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [6]: </span><span class="n">sinc</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<span class="gr">Out[6]: </span><span class="n">nan</span>
</pre></div>
</div>
<p>IPython returns <tt class="docutils literal"><span class="pre">nan</span></tt> or &#8220;not a number&#8221;, which occurs when Python attempts a division by zero, which is not defined.  This is not the desired response as <img class="math" src="../_images/math/5db5939f2972aee19dd2afe3e2a5a6e2e5f8f9af.png" alt="\mathrm{sinc}\,x"/> is, in fact, perfectly well defined for <img class="math" src="../_images/math/55ba271999995cac02cf578362df5be030594ed6.png" alt="x=0"/>.  You can verify this using L&#8217;Hopital&#8217;s rule, which you may have learned in your study of calculus, or you can ascertain the correct answer by calculating the Taylor series for <img class="math" src="../_images/math/5db5939f2972aee19dd2afe3e2a5a6e2e5f8f9af.png" alt="\mathrm{sinc}\,x"/>.  Here is what we get</p>
<div class="math">
<p><img src="../_images/math/3bdff8783866967a20d958db50ba0f31c4b3cbd4.png" alt="\mathrm{sinc}\,x = \frac{\sin x}{x}
                = \frac{x - \frac{x^3}{3!} + \frac{x^5}{5!} + ...}{x}
                = 1 - \frac{x^2}{3!} + \frac{x^4}{5!} + ... \;."/></p>
</div><p>From the Taylor series, it is clear that <img class="math" src="../_images/math/5db5939f2972aee19dd2afe3e2a5a6e2e5f8f9af.png" alt="\mathrm{sinc}\,x"/> is well-defined at and near <img class="math" src="../_images/math/55ba271999995cac02cf578362df5be030594ed6.png" alt="x=0"/> and that, in fact,  <img class="math" src="../_images/math/bd58eaab83ea2b5bb41a1bf60864e8d204edd6ea.png" alt="\mathrm{sinc}(0)=1"/>.  Let&#8217;s modify our function so that it gives the correct value for <tt class="docutils literal"><span class="pre">x=0</span></tt>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [7]: </span><span class="k">def</span> <span class="nf">sinc</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">   ...:</span>     <span class="k">if</span> <span class="n">x</span><span class="o">==</span><span class="mf">0.0</span><span class="p">:</span>
<span class="gp">   ...:</span>         <span class="n">y</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">   ...:</span>     <span class="k">else</span><span class="p">:</span>
<span class="gp">   ...:</span>         <span class="n">y</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span>
<span class="gp">   ...:</span>     <span class="k">return</span> <span class="n">y</span>

<span class="gp">In [8]: </span><span class="n">sinc</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gr">Out[8]: </span><span class="mf">1.0</span>

<span class="gp">In [9]: </span><span class="n">sinc</span><span class="p">(</span><span class="mf">1.2</span><span class="p">)</span>
<span class="gr">Out[9]: </span><span class="mf">0.77669923830602194</span>
</pre></div>
</div>
<p>Now our function gives the correct value for <tt class="docutils literal"><span class="pre">x=0</span></tt> as well as for values different from zero.</p>
<div class="section" id="looping-over-arrays-in-user-defined-functions">
<span id="loopingarrays"></span><span id="index-1"></span><h3>7.1.1. Looping over arrays in user-defined functions<a class="headerlink" href="#looping-over-arrays-in-user-defined-functions" title="Permalink to this headline">¶</a></h3>
<p>The code for <img class="math" src="../_images/math/5db5939f2972aee19dd2afe3e2a5a6e2e5f8f9af.png" alt="\mathrm{sinc}\,x"/> works just fine when the argument is a single number or a variable that represents a single number.  However, if the argument is a NumPy array, we run into a problem, as illustrated below.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [10]: </span><span class="n">x</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">5.</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>

<span class="gp">In [11]: </span><span class="n">x</span>
<span class="gr">Out[11]: </span><span class="n">array</span><span class="p">([</span> <span class="mf">0.</span> <span class="p">,</span>  <span class="mf">0.5</span><span class="p">,</span>  <span class="mf">1.</span> <span class="p">,</span>  <span class="mf">1.5</span><span class="p">,</span>  <span class="mf">2.</span> <span class="p">,</span>  <span class="mf">2.5</span><span class="p">,</span>  <span class="mf">3.</span> <span class="p">,</span>  <span class="mf">3.5</span><span class="p">,</span>
<span class="go">                 4. ,  4.5])</span>

<span class="gp">In [12]: </span><span class="n">sinc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">----------------------------------------------------------</span>
<span class="go">ValueError               Traceback (most recent call last)</span>
<span class="go">----&gt; 1 sinc(x)</span>

<span class="go">      1 def sinc(x):</span>
<span class="go">----&gt; 2     if x==0.0:</span>
<span class="go">      3         y = 1.0</span>
<span class="go">      4     else:</span>
<span class="go">      5         y = np.sin(x)/x</span>

<span class="go">ValueError: The truth value of an array with more than one</span>
<span class="go">            element is ambiguous.</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">if</span></tt> statement in Python is set up to evaluate the truth value of a single variable, not of multielement arrays.  When Python is asked to evaluate the truth value for a multi-element array, it doesn&#8217;t know what to do and therefore returns an error.</p>
<p>An obvious way to handle this problem is to write the code so that it processes the array one element at a time, which you could do using a <tt class="docutils literal"><span class="pre">for</span></tt> loop, as illustrated below.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">sinc</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>              <span class="c"># creates an empty list to store results</span>
    <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>        <span class="c"># loops over all elements in x array</span>
        <span class="k">if</span> <span class="n">xx</span><span class="o">==</span><span class="mf">0.0</span><span class="p">:</span>     <span class="c"># adds result of 1.0 to y list if</span>
            <span class="n">y</span> <span class="o">+=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>  <span class="c"># xx is zero</span>
        <span class="k">else</span><span class="p">:</span>           <span class="c"># adds result of sin(xx)/xx to y list if</span>
            <span class="n">y</span> <span class="o">+=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span><span class="o">/</span><span class="n">xx</span><span class="p">]</span>  <span class="c"># xx is not zero</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>  <span class="c"># converts y to array and returns array</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sinc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>The <tt class="docutils literal"><span class="pre">for</span></tt> loop evaluates the elements of the <tt class="docutils literal"><span class="pre">x</span></tt> array one by one and appends the results to the list <tt class="docutils literal"><span class="pre">y</span></tt> one by one.  When it is finished, it converts the list to an array and returns the array.  The code following the function definition plots <img class="math" src="../_images/math/5db5939f2972aee19dd2afe3e2a5a6e2e5f8f9af.png" alt="\mathrm{sinc}\,x"/> as a function of <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/>.</p>
<p>In the program above, you may have noticed that the NumPy library is imported <em>after</em> the <tt class="docutils literal"><span class="pre">sinc(x)</span></tt> function definition.  As the function uses the NumPy functions <tt class="docutils literal"><span class="pre">sin</span></tt> and <tt class="docutils literal"><span class="pre">array</span></tt>, you may wonder how this program can work.  Doesn&#8217;t the <tt class="docutils literal"><span class="pre">import</span> <span class="pre">numpy</span></tt> statement have to be called before any NumPy functions are used?  The answer it an emphatic &#8220;YES&#8221;.  What you need to understand is that the function definition is <em>not executed</em> when it is defined, nor can it be as it has no input <tt class="docutils literal"><span class="pre">x</span></tt> data to process.  That part of the code is just a definition.  The first time the code for the <tt class="docutils literal"><span class="pre">sinc(x)</span></tt> function is actually executed is when it is called on line 14 of the program, which occurs after the NumPy library is imported in line 10.  The figure below shows the plot of the <img class="math" src="../_images/math/5db5939f2972aee19dd2afe3e2a5a6e2e5f8f9af.png" alt="\mathrm{sinc}\,x"/> function generated by the above code.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/sinc.png"><img alt="sinc function" src="../_images/sinc.png" style="width: 640.0px; height: 480.0px;" /></a>
<p class="caption">Plot of user-defined <tt class="docutils literal"><span class="pre">sinc(x)</span></tt> function.</p>
</div>
</div>
<div class="section" id="fast-array-processing-in-user-defined-functions">
<span id="index-2"></span><h3>7.1.2. Fast array processing in user-defined functions<a class="headerlink" href="#fast-array-processing-in-user-defined-functions" title="Permalink to this headline">¶</a></h3>
<p>While using loops to process arrays works just fine, it is usually not the best way to accomplish the task in Python.  The reason is that loops in Python are executed rather slowly.  To deal with this problem, the developers of NumPy introduced a number of functions designed to process arrays quickly and efficiently.  For the present case, what we need is a conditional statement or function that can process arrays directly.  The function we want is called <tt class="docutils literal"><span class="pre">where</span></tt> and it is a part of the NumPy library.  There <tt class="docutils literal"><span class="pre">where</span></tt> function has the form</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">where</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">output</span> <span class="k">if</span> <span class="bp">True</span><span class="p">,</span> <span class="n">output</span> <span class="k">if</span> <span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<p>The first argument of the <tt class="docutils literal"><span class="pre">where</span></tt> function is a conditional statement involving an array.  The <tt class="docutils literal"><span class="pre">where</span></tt> function applies the condition to the array element by element, and returns the second argument for those array elements for which the condition is <tt class="docutils literal"><span class="pre">True</span></tt>, and returns the third argument for those array elements that are <tt class="docutils literal"><span class="pre">False</span></tt>.  We can apply it to the <tt class="docutils literal"><span class="pre">sinc(x)</span></tt> function as follows</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">sinc</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">z</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">where</span></tt> function creates the array <tt class="docutils literal"><span class="pre">y</span></tt> and sets the elements of <tt class="docutils literal"><span class="pre">y</span></tt> equal to 1.0 where the corresponding elements of <tt class="docutils literal"><span class="pre">x</span></tt> are zero, and otherwise sets the corresponding elements to <tt class="docutils literal"><span class="pre">sin(x)/x</span></tt>.  This code executes much faster, 25 to 100 times, depending on the size of the array, than the code using a <tt class="docutils literal"><span class="pre">for</span></tt> loop.  Moreover, the new code is much simpler to write and read.  An additional benefit of the <tt class="docutils literal"><span class="pre">where</span></tt> function is that it can handle single variables and arrays equally well.  The code we wrote for the sinc function with the <tt class="docutils literal"><span class="pre">for</span></tt> loop cannot handle single variables.  Of course we could rewrite the code so that it did, but the code becomes even more clunky.  It&#8217;s better just to use NumPy&#8217;s <tt class="docutils literal"><span class="pre">where</span></tt> function.</p>
<div class="section" id="the-moral-of-the-story">
<h4>7.1.2.1. The moral of the story<a class="headerlink" href="#the-moral-of-the-story" title="Permalink to this headline">¶</a></h4>
<p>The moral of the story is that you should avoid using <tt class="docutils literal"><span class="pre">for</span></tt> and <tt class="docutils literal"><span class="pre">while</span></tt> loops to process arrays in Python programs whenever an array-processing method is available.  As a beginning Python programmer, you may not always see how to avoid loops, and indeed, avoiding them is not always possible, but you should look for ways to avoid loops, especially loops that iterate a large number of times. As you become more experienced, you will find that using array-processing methods in Python becomes more natural. Using them can greatly speed up the execution of your code, especially when working with large arrays.</p>
</div>
</div>
<div class="section" id="functions-with-more-or-less-than-one-input-or-output">
<span id="index-3"></span><h3>7.1.3. Functions with more (or less) than one input or output<a class="headerlink" href="#functions-with-more-or-less-than-one-input-or-output" title="Permalink to this headline">¶</a></h3>
<p>Python functions can have any number of input arguments and can return any number of variables.  For example, suppose you want a function that outputs <img class="math" src="../_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/> <img class="math" src="../_images/math/5f81ea407dc24031569231ab2cd28222176f38ca.png" alt="(x,y)"/> coordinates around a circle of radius <img class="math" src="../_images/math/2ede365ad144ab396916ec60458da03860803078.png" alt="r"/> centered at the point <img class="math" src="../_images/math/bfd6ca45953d0c6ff82172022440d2fec96cc301.png" alt="(x_0,y_0)"/>.  The inputs to the function would be  <img class="math" src="../_images/math/2ede365ad144ab396916ec60458da03860803078.png" alt="r"/>, <img class="math" src="../_images/math/c3c08496f07567285212e468b173bea9ca153fab.png" alt="x_0"/>, <img class="math" src="../_images/math/f7e73389b494d356293b5ad9e3601a3a61609e96.png" alt="y_0"/>, and  <img class="math" src="../_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/>.  The outputs would be the <img class="math" src="../_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/> <img class="math" src="../_images/math/5f81ea407dc24031569231ab2cd28222176f38ca.png" alt="(x,y)"/> coordinates.  The following code implements this function.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">circle</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x0</span><span class="o">+</span><span class="n">x</span><span class="p">,</span> <span class="n">y0</span><span class="o">+</span><span class="n">y</span>
</pre></div>
</div>
<p>This function has four inputs and two outputs.  In this case, the four inputs are simple numeric variables and the two outputs are NumPy arrays.  In general, the inputs and outputs can be any combination of data types: arrays, lists, strings, <em>etc</em>. Of course, the body of the function must be written to be consistent with the prescribed data types.</p>
<p>Functions can also return nothing to the calling program but just perform some task.  For example, here is a program that clears the terminal screen</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">platform</span>

<span class="k">def</span> <span class="nf">clear</span><span class="p">():</span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span> <span class="s">&quot;cls&quot;</span> <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span>
                      <span class="s">&quot;Windows&quot;</span> <span class="k">else</span> <span class="s">&quot;clear&quot;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The function is invoked by typing <tt class="docutils literal"><span class="pre">clear()</span></tt>.  It has no inputs and no outputs but it performs a useful task.  This function uses two standard Python libraries, <tt class="docutils literal"><span class="pre">subprocess</span></tt> and <tt class="docutils literal"><span class="pre">platform</span></tt> that are useful for performing computer system tasks.  It&#8217;s not important that you know anything about them at this point.  We simply use them here to demonstrate a useful cross-platform function that has no inputs and returns no values.</p>
</div>
<div class="section" id="positional-and-keyword-arguments">
<span id="index-4"></span><h3>7.1.4. Positional and keyword arguments<a class="headerlink" href="#positional-and-keyword-arguments" title="Permalink to this headline">¶</a></h3>
<p>It is often useful to have function arguments that have some default setting.  This happens when you want an input to a function to have some standard value or setting most of the time, but you would like to reserve the possibility of giving it some value other than the default value.</p>
<p>For example, in the program <tt class="docutils literal"><span class="pre">circle</span></tt> from the previous section, we might decide that under most circumstances, we want <tt class="docutils literal"><span class="pre">n=12</span></tt> points around the circle, like the points on a clock face, and we want the circle to be centered at the origin.  In this case, we would rewrite the code to read</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">circle</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">12</span><span class="p">):</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x0</span><span class="o">+</span><span class="n">x</span><span class="p">,</span> <span class="n">y0</span><span class="o">+</span><span class="n">y</span>
</pre></div>
</div>
<p>The default values of the arguments <tt class="docutils literal"><span class="pre">x0</span></tt>, <tt class="docutils literal"><span class="pre">y0</span></tt>, and <tt class="docutils literal"><span class="pre">n</span></tt> are specified in the argument of the function definition in the <tt class="docutils literal"><span class="pre">def</span></tt> line.  Arguments whose default values are specified in this manner are called <em>keyword arguments</em>, and they can be omitted from the function call if the user is content using those values.  For example, writing <tt class="docutils literal"><span class="pre">circle(4)</span></tt> is now a perfectly legal way to call the <tt class="docutils literal"><span class="pre">circle</span></tt> function and it would produce 12 <img class="math" src="../_images/math/5f81ea407dc24031569231ab2cd28222176f38ca.png" alt="(x,y)"/> coordinates centered about the origin <img class="math" src="../_images/math/b341b784ff94c12e8a1c8c5ababb7896f8e9cef0.png" alt="(x,y)=(0,0)"/>.  On the other hand, if you want the values of  <tt class="docutils literal"><span class="pre">x0</span></tt>, <tt class="docutils literal"><span class="pre">y0</span></tt>, and <tt class="docutils literal"><span class="pre">n</span></tt> to be something different from the default values, you can specify their values as you would have before.</p>
<p>If you want to change only some of the keyword arguments, you can do so by using the keywords in the function call.  For example, suppose you are content with have the circle centered on <img class="math" src="../_images/math/b341b784ff94c12e8a1c8c5ababb7896f8e9cef0.png" alt="(x,y)=(0,0)"/> but you want only 6 points around the circle rather than 12.  Then you would call the <tt class="docutils literal"><span class="pre">circle</span></tt> function as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">circle</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
<p>The unspecified keyword arguments keep their default values of zero but the number of points <tt class="docutils literal"><span class="pre">n</span></tt> around the circle is now 6 instead of the default value of 12.</p>
<p>The normal arguments without keywords are called <em>positional arguments</em>; they have to appear <em>before</em> any keyword arguments and, when the function is called, must be supplied values in the same order as specified in the function definition.  The keyword arguments, if supplied, can be supplied in any order providing they are supplied with their keywords.  If supplied without their keywords, they too must be supplied in the order they appear in the function definition.  The following function calls to <tt class="docutils literal"><span class="pre">circle</span></tt> both give the same output.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [13]: </span><span class="n">circle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">x0</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
<span class="gr">Out[13]: </span><span class="p">(</span><span class="n">array</span><span class="p">([</span> <span class="mf">1.</span> <span class="p">,</span> <span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.5</span><span class="p">]),</span>
<span class="go">          array([ 4.        ,  6.59807621,  1.40192379]))</span>

<span class="gp">In [14]: </span><span class="n">circle</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>    <span class="c"># w/o keywords, arguments</span>
<span class="go">                                # supplied in order</span>
<span class="gr">Out[14]: </span><span class="p">(</span><span class="n">array</span><span class="p">([</span> <span class="mf">1.</span> <span class="p">,</span> <span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.5</span><span class="p">]),</span> <span class="n">array</span><span class="p">([</span> <span class="mf">4.</span>        <span class="p">,</span>
<span class="go">                  6.59807621,  1.40192379]))</span>
</pre></div>
</div>
<p>By now you probably have noticed that we used the keyword argument <tt class="docutils literal"><span class="pre">endpoint</span></tt> in calling <tt class="docutils literal"><span class="pre">linspace</span></tt> in our definition of the <tt class="docutils literal"><span class="pre">circle</span></tt> function.  The default value of <tt class="docutils literal"><span class="pre">endpoint</span></tt> is <tt class="docutils literal"><span class="pre">True</span></tt>, meaning that <tt class="docutils literal"><span class="pre">linspace</span></tt> includes the endpoint specified in the second argument of <tt class="docutils literal"><span class="pre">linspace</span></tt>.  We set it equal to <tt class="docutils literal"><span class="pre">False</span></tt> so that the last point was not included.  Do you see why?</p>
</div>
<div class="section" id="variable-number-of-arguments">
<span id="index-5"></span><h3>7.1.5. Variable number of arguments<a class="headerlink" href="#variable-number-of-arguments" title="Permalink to this headline">¶</a></h3>
<p>While it may seem odd, it is sometimes useful to leave the number of arguments unspecified.  A simple example is a function that computes the product of an arbitrary number of numbers:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">product</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;args = {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">args</span><span class="p">))</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">*=</span> <span class="n">num</span>
    <span class="k">return</span> <span class="n">p</span>
</pre></div>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [15]: </span><span class="n">product</span><span class="p">(</span><span class="mf">11.</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">args = (11.0, -2, 3)</span>
<span class="gr">Out[15]: </span><span class="o">-</span><span class="mf">66.0</span>

<span class="gp">In [16]: </span><span class="n">product</span><span class="p">(</span><span class="mf">2.31</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">args = (2.31, 7)</span>
<span class="gr">Out[16]: </span><span class="mf">16.17</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">print(&quot;args...)</span></tt> statement in the function definition is not necessary, of course, but is put in to show that the argument <tt class="docutils literal"><span class="pre">args</span></tt> is a tuple inside the function.  Here it used because one does not know ahead of time how many numbers are to be multiplied together.</p>
<p>The <tt class="docutils literal"><span class="pre">*args</span></tt> argument is also quite useful in another context: when passing the name of a function as an argument in another function.  In many cases, the function name that is passed may have a number of parameters that must also be passed but aren&#8217;t known ahead of time.  If this all sounds a bit confusing&#8212;functions calling other functions&#8212;a concrete example will help you understand.</p>
<p>Suppose we have the following function that numerically computes the value of the derivative of an arbitrary function <img class="math" src="../_images/math/14546c27a7b929642f7840acca5f851c503ea109.png" alt="f(x)"/>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">deriv</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="o">=</span><span class="mf">1.e-9</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">)</span><span class="o">-</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">*</span><span class="n">params</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
<p>The argument <tt class="docutils literal"><span class="pre">*params</span></tt> is an optional positional argument.  We begin by demonstrating the use of the function <tt class="docutils literal"><span class="pre">deriv</span></tt> without using the optional <tt class="docutils literal"><span class="pre">*params</span></tt> argument.  Suppose we want to compute the derivative of the function <img class="math" src="../_images/math/912be49918cad30ea7be902eaf723abd2cafb31e.png" alt="f_0(x)=4x^5"/>.  First, we define the function</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">f0</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">4.</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">5</span>
</pre></div>
</div>
<p>Now let&#8217;s find the derivative of <img class="math" src="../_images/math/912be49918cad30ea7be902eaf723abd2cafb31e.png" alt="f_0(x)=4x^5"/> at <img class="math" src="../_images/math/3043980dd8b17915638fe503133a6c232fab1263.png" alt="x=3"/> using the function <tt class="docutils literal"><span class="pre">deriv</span></tt>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [17]: </span><span class="n">deriv</span><span class="p">(</span><span class="n">f0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gr">Out[17]: </span><span class="mf">1620.0001482502557</span>
</pre></div>
</div>
<p>The exact result, given by evaluating <img class="math" src="../_images/math/495d03d809a9b9bb043ddc1b6f8aa757dfd12d7b.png" alt="f_0^\prime(x)=20x^4"/> at <img class="math" src="../_images/math/3043980dd8b17915638fe503133a6c232fab1263.png" alt="x=3"/> is 1620, so our function to numerically calculate the derivative works pretty well.</p>
<p>Suppose we had defined a more general function <img class="math" src="../_images/math/6ce1a4c64c3d0a795adf589c2cb27bf95f93f7a1.png" alt="f_1(x)=ax^p"/> as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="n">p</span>
</pre></div>
</div>
<p>Suppose we want to calculate the derivative of this function for a particular set of parameters <img class="math" src="../_images/math/7dd2a5ea01fbd72ad2a58dd1f3d6ecbfde6208a1.png" alt="a"/> and <img class="math" src="../_images/math/3eca8557203e86160952e1c0f735f7417f3285b1.png" alt="p"/>.  Now we face a problem, because it might seem that there is no way to pass the parameters <img class="math" src="../_images/math/7dd2a5ea01fbd72ad2a58dd1f3d6ecbfde6208a1.png" alt="a"/> and <img class="math" src="../_images/math/3eca8557203e86160952e1c0f735f7417f3285b1.png" alt="p"/> to the <tt class="docutils literal"><span class="pre">deriv</span></tt> function.  Moreover, this is a generic problem for functions such as <tt class="docutils literal"><span class="pre">deriv</span></tt> that use a function as an input, because different functions you want to use as inputs generally come with different parameters. Therefore, we would like to write our program <tt class="docutils literal"><span class="pre">deriv</span></tt> so that it works, irrespective of how many parameters are needed to specify a particular function.</p>
<p>This is what the optional positional argument <tt class="docutils literal"><span class="pre">*params</span></tt> defined in <tt class="docutils literal"><span class="pre">deriv</span></tt> is for: to pass parameters of <tt class="docutils literal"><span class="pre">f1</span></tt>, like <img class="math" src="../_images/math/7dd2a5ea01fbd72ad2a58dd1f3d6ecbfde6208a1.png" alt="a"/> and <img class="math" src="../_images/math/5e87bf41a96deddf6cb485ff530f153f2590e9cc.png" alt="b"/>, through <tt class="docutils literal"><span class="pre">deriv</span></tt>.  To see how this works, let&#8217;s set <img class="math" src="../_images/math/7dd2a5ea01fbd72ad2a58dd1f3d6ecbfde6208a1.png" alt="a"/> and <img class="math" src="../_images/math/5e87bf41a96deddf6cb485ff530f153f2590e9cc.png" alt="b"/> to be 4 and 5, respectively, the same values we used in the definition of <tt class="docutils literal"><span class="pre">f0</span></tt>, so that we can compare the results:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [16]: </span><span class="n">deriv</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">1.e-9</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gr">Out[16]: </span><span class="mf">1620.0001482502557</span>
</pre></div>
</div>
<p>We get the same answer as before, but this time we have used <tt class="docutils literal"><span class="pre">deriv</span></tt> with a more general form of the function <img class="math" src="../_images/math/6ce1a4c64c3d0a795adf589c2cb27bf95f93f7a1.png" alt="f_1(x)=ax^p"/>.</p>
<p>The order of the parameters is important.  The function <tt class="docutils literal"><span class="pre">deriv</span></tt> uses <tt class="docutils literal"><span class="pre">x</span></tt>, the first argument of <tt class="docutils literal"><span class="pre">f1</span></tt>, as its principal argument, and then uses <tt class="docutils literal"><span class="pre">a</span></tt> and <tt class="docutils literal"><span class="pre">p</span></tt>, in the same order that they are defined in the function <tt class="docutils literal"><span class="pre">f1</span></tt>, to fill in the additional arguments&#8212;the parameters&#8212;of the function <tt class="docutils literal"><span class="pre">f1</span></tt>.</p>
<p id="index-6">Optional arguments must appear after the regular positional and keyword arguments in a function call. The order of the arguments must adhere to the following convention:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">pos1</span><span class="p">,</span> <span class="n">pos2</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">keywd1</span><span class="p">,</span> <span class="n">keywd2</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</pre></div>
</div>
<p>That is, the order of arguments is: positional arguments first, then keyword arguments, then optional positional arguments (<tt class="docutils literal"><span class="pre">*args</span></tt>), then optional keyword arguments (<tt class="docutils literal"><span class="pre">**kwargs</span></tt>).  Note that to use the <tt class="docutils literal"><span class="pre">*params</span></tt> argument, we had to explicitly include the keyword argument <tt class="docutils literal"><span class="pre">h</span></tt> even though we didn&#8217;t need to change it from its default value.</p>
<p>Python also allows for a variable number of keyword arguments&#8212;<tt class="docutils literal"><span class="pre">**kwargs</span></tt>&#8212;in a function call.  While <tt class="docutils literal"><span class="pre">*args</span></tt> is a tuple, <tt class="docutils literal"><span class="pre">kwargs</span></tt> is a dictionary, so that the value of an optional keyword argument is accessed through its dictionary key.</p>
</div>
<div class="section" id="passing-data-to-and-from-functions">
<h3>7.1.6. Passing data to and from functions<a class="headerlink" href="#passing-data-to-and-from-functions" title="Permalink to this headline">¶</a></h3>
<p>Functions are like mini-programs within the larger programs that call them.  Each function has a set of variables with certain names that are to some degree or other isolated from the calling program.  We shall get more specific about just how isolated those variables are below, but before we do, we introduce the concept of a <em>namespace</em>.  Each function has its own namespace, which is essentially a mapping of variable names to objects, like numerics, strings, lists, and so forth.  It&#8217;s a kind of dictionary.  The calling program has its own namespace, distinct from that of any functions it calls.  The distinctiveness of these namespaces plays an important role in how functions work, as we shall see below.</p>
<div class="section" id="variables-and-arrays-created-entirely-within-a-function">
<h4>7.1.6.1. Variables and arrays created entirely within a function<a class="headerlink" href="#variables-and-arrays-created-entirely-within-a-function" title="Permalink to this headline">¶</a></h4>
<p>An important feature of functions is that variables and arrays created <em>entirely within</em> a function cannot be seen by the program that calls the function unless the variable or array is explicitly passed to the calling program in the <tt class="docutils literal"><span class="pre">return</span></tt> statement.  This is important because it means you can create and manipulate variables and arrays, giving them any name you please, without affecting any variables or arrays outside the function, even if the variables and arrays inside and outside a function share the same name.</p>
<p>To see what how this works, let&#8217;s rewrite our program to plot the sinc function using the sinc function definition that uses the <tt class="docutils literal"><span class="pre">where</span></tt> function.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">sinc</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">z</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sinc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>Running this program produces a plot like the plot of sinc shown in the previous section.  Notice that the array variable <tt class="docutils literal"><span class="pre">z</span></tt> is only defined within the function definition of sinc.  If we run the program from the IPython terminal, it produces the plot, of course.  Then if we ask IPython to print out the arrays, <tt class="docutils literal"><span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">y</span></tt>, and <tt class="docutils literal"><span class="pre">z</span></tt>, we get some interesting and informative results, as shown below.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [15]: </span><span class="n">run</span> <span class="n">sinc3</span><span class="o">.</span><span class="n">py</span>

<span class="gp">In [16]: </span><span class="n">x</span>
<span class="gr">Out[16]: </span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">10.</span>        <span class="p">,</span>  <span class="o">-</span><span class="mf">9.99969482</span><span class="p">,</span>  <span class="o">-</span><span class="mf">9.99938964</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>
<span class="go">         9.99938964,   9.99969482,  10.        ])</span>

<span class="gp">In [17]: </span><span class="n">y</span>
<span class="gr">Out[17]: </span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.05440211</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05437816</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0543542</span> <span class="p">,</span> <span class="o">...</span><span class="p">,</span>
<span class="go">                -0.0543542 , -0.05437816, -0.05440211])</span>

<span class="gp">In [18]: </span><span class="n">z</span>
<span class="go">---------------------------------------------------------</span>
<span class="go">NameError               Traceback (most recent call last)</span>

<span class="go">NameError: name &#39;z&#39; is not defined</span>
</pre></div>
</div>
<p>When we type in <tt class="docutils literal"><span class="pre">x</span></tt> at the <tt class="docutils literal"><span class="pre">In</span> <span class="pre">[16]:</span></tt> prompt, IPython prints out the array <tt class="docutils literal"><span class="pre">x</span></tt> (some of the output is suppressed because the array <tt class="docutils literal"><span class="pre">x</span></tt> has many elements); similarly for <tt class="docutils literal"><span class="pre">y</span></tt>.  But when we type <tt class="docutils literal"><span class="pre">z</span></tt> at the <tt class="docutils literal"><span class="pre">In</span> <span class="pre">[18]:</span></tt> prompt, IPython returns a <tt class="docutils literal"><span class="pre">NameError</span></tt> because <tt class="docutils literal"><span class="pre">z</span></tt> is not defined.  The IPython terminal is working in the same <em>namespace</em> as the program.  But the namespace of the sinc function is isolated from the namespace of the program that calls it, and therefore isolated from IPython.  This also means that when the sinc function ends with <tt class="docutils literal"><span class="pre">return</span> <span class="pre">z</span></tt>, it doesn&#8217;t return the name <tt class="docutils literal"><span class="pre">z</span></tt>, but instead assigns the values in the array <tt class="docutils literal"><span class="pre">z</span></tt> to the array <tt class="docutils literal"><span class="pre">y</span></tt>, as directed by the main program in line 9.</p>
</div>
<div class="section" id="passing-variables-and-arrays-to-functions-mutable-and-immutable-objects">
<h4>7.1.6.2. Passing variables and arrays to functions: mutable and immutable objects<a class="headerlink" href="#passing-variables-and-arrays-to-functions-mutable-and-immutable-objects" title="Permalink to this headline">¶</a></h4>
<p>What happens to a variable or an array passed to a function when the variable or array is <em>changed</em> within the function?  It turns out that the answers are different depending on whether the variable passed is a simple numeric variable, string, or tuple, or whether it is an array or list.  The program below illustrates the different ways that Python handles single variables <em>vs</em> the way it handles lists and arrays.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="s">&quot;I am doing fine&quot;</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">)</span>
    <span class="n">l</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;end&#39;</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">963.2</span>
    <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">a</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">s</span> <span class="o">=</span> <span class="s">&quot;How do you do?&quot;</span>
<span class="n">v</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="mf">97.5</span><span class="p">,</span> <span class="mf">82.9</span><span class="p">,</span> <span class="mf">66.7</span><span class="p">)</span>
<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.9</span><span class="p">,</span> <span class="mf">5.7</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="mf">9.3</span><span class="p">]</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&#39;*************&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;s = {0:s}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;v = {0:5.2f}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;t = {0:s}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;l = {0:s}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;a = &quot;</span><span class="p">),</span>              <span class="c"># comma suppresses line feed</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;*************&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;*call &quot;test&quot;*&#39;</span><span class="p">)</span>

<span class="n">s1</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">a1</span> <span class="o">=</span> <span class="n">test</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">&#39;*************&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;s1 = {0:s}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s1</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;v1 = {0:5.2f}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v1</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;t1 = {0:s}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t1</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;l1 = {0:s}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l1</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;a1 = &quot;</span><span class="p">),</span>
<span class="k">print</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;*************&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;s = {0:s}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;v = {0:5.2f}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;t = {0:s}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;l = {0:s}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;a = &quot;</span><span class="p">),</span>              <span class="c"># comma suppresses line feed</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;*************&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The function <tt class="docutils literal"><span class="pre">test</span></tt> has five arguments, a string <tt class="docutils literal"><span class="pre">s</span></tt>, a numerical variable <tt class="docutils literal"><span class="pre">v</span></tt>, a tuple <tt class="docutils literal"><span class="pre">t</span></tt>, a list <tt class="docutils literal"><span class="pre">l</span></tt>, and a NumPy array <tt class="docutils literal"><span class="pre">a</span></tt>.  <tt class="docutils literal"><span class="pre">test</span></tt> modifies each of these arguments and then returns the modified <tt class="docutils literal"><span class="pre">s</span></tt>, <tt class="docutils literal"><span class="pre">v</span></tt>, <tt class="docutils literal"><span class="pre">t</span></tt>, <tt class="docutils literal"><span class="pre">l</span></tt>, <tt class="docutils literal"><span class="pre">a</span></tt>.  Running the program produces the following output.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [17]: </span><span class="n">run</span> <span class="n">passingVars</span><span class="o">.</span><span class="n">py</span>
<span class="go">*************</span>
<span class="go">s = How do you do?</span>
<span class="go">v =  5.00</span>
<span class="go">t = (97.5, 82.9, 66.7)</span>
<span class="go">l = [3.9, 5.7, 7.5, 9.3]</span>
<span class="go">a =  [ 3.9  5.7  7.5  9.3]</span>
<span class="go">*************</span>
<span class="go">*call &quot;test&quot;*</span>
<span class="go">*************</span>
<span class="go">s1 = I am doing fine</span>
<span class="go">v1 =  9.87</span>
<span class="go">t1 = (1.1, 2.9)</span>
<span class="go">l1 = [3.9, 5.7, 7.5, &#39;end&#39;]</span>
<span class="go">a1 =  [ 963.2    5.7    7.5    9.3]</span>
<span class="go">*************</span>
<span class="go">s = How do you do?</span>
<span class="go">v =  5.00</span>
<span class="go">t = (97.5, 82.9, 66.7)</span>
<span class="go">l = [3.9, 5.7, 7.5, &#39;end&#39;]</span>
<span class="go">a =  [ 963.2    5.7    7.5    9.3]</span>
<span class="go">*************</span>
</pre></div>
</div>
<p>The program prints out three blocks of variables separated by asterisks.  The first block merely verifies that the contents of <tt class="docutils literal"><span class="pre">s</span></tt>, <tt class="docutils literal"><span class="pre">v</span></tt>, <tt class="docutils literal"><span class="pre">t</span></tt>, <tt class="docutils literal"><span class="pre">l</span></tt>, and <tt class="docutils literal"><span class="pre">a</span></tt> are those assigned in lines 10-13.  Then the function <tt class="docutils literal"><span class="pre">test</span></tt> is called.  The next block prints the output of the call to the function <tt class="docutils literal"><span class="pre">test</span></tt>, namely the variables  <tt class="docutils literal"><span class="pre">s1</span></tt>, <tt class="docutils literal"><span class="pre">v1</span></tt>, <tt class="docutils literal"><span class="pre">t1</span></tt>, <tt class="docutils literal"><span class="pre">l1</span></tt>, and <tt class="docutils literal"><span class="pre">a1</span></tt>.  The results verify that the function modified the inputs as directed by the <tt class="docutils literal"><span class="pre">test</span></tt> function.</p>
<p>The third block prints out the variables <tt class="docutils literal"><span class="pre">s</span></tt>, <tt class="docutils literal"><span class="pre">v</span></tt>, <tt class="docutils literal"><span class="pre">t</span></tt>, <tt class="docutils literal"><span class="pre">l</span></tt>, and <tt class="docutils literal"><span class="pre">a</span></tt> from the calling program <em>after</em> the function <tt class="docutils literal"><span class="pre">test</span></tt> was called.  These variables served as the inputs to the function <tt class="docutils literal"><span class="pre">test</span></tt>.  Examining the output from the third printing block, we see that the values of the string <tt class="docutils literal"><span class="pre">s</span></tt>, the numeric variable <tt class="docutils literal"><span class="pre">v</span></tt>, and the contents of <tt class="docutils literal"><span class="pre">t</span></tt> are unchanged after the function call.  This is probably what you would expect.  On the other hand, we see that the list <tt class="docutils literal"><span class="pre">l</span></tt> and the array <tt class="docutils literal"><span class="pre">a</span></tt> are changed after the function call.  This might surprise you!  But these are important points to remember, so important that we summarize them in two bullet points here:</p>
<blockquote>
<div><ul class="simple">
<li>Changes to string, variable, and tuple arguments of a function within the function do not affect their values in the calling program.</li>
<li>Changes to values of elements in list and array arguments of a function within the function are reflected in the values of the same list and array elements in the calling function.</li>
</ul>
</div></blockquote>
<p>The point is that simple numerics, strings and tuples are immutable while lists and arrays are mutable.  Because immutable objects can&#8217;t be changed, changing them within a function creates new objects with the same name inside of the function, but the old immutable objects that were used as arguments in the function call remain unchanged in the calling program.  On the other hand, if elements of mutable objects like those in lists or arrays are changed, then those elements that are changed inside the function are also changed in the calling program.</p>
</div>
</div>
</div>
<div class="section" id="methods-and-attributes">
<h2>7.2. Methods and attributes<a class="headerlink" href="#methods-and-attributes" title="Permalink to this headline">¶</a></h2>
<p>You have already encountered quite a number of functions that are part of either NumPy or Python or Matplotlib.  But there is another way in which Python implements things that act like functions.  To understand what they are, you need to understand that variables, strings, arrays, lists, and other such data structures in Python are not merely the numbers or strings we have defined them to be.  They are <em>objects</em>.  In general, an object in Python has associated with it a number of <em>attributes</em> and a number of specialized functions called <em>methods</em> that act on the object.  How attributes and methods work with objects is best illustrated by example.</p>
<p>Let&#8217;s start with the NumPy array.  A NumPy array is a Python object and therefore has associated with it a number of attributes and methods. Suppose, for example, we write <tt class="docutils literal"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">random.random(10)</span></tt>, which creates an array of 10 uniformly distributed random numbers between 0 and 1.  An example of an attribute of an array is the size or number of elements in the array.  An attribute of an object in Python is accessed by typing the object name followed by a period followed by the attribute name.  The code below illustrates how to access two different attributes of an array, it&#8217;s size and its data type.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [18]: </span><span class="n">a</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="gp">In [19]: </span><span class="n">a</span><span class="o">.</span><span class="n">size</span>
<span class="gr">Out[19]: </span><span class="mi">10</span>

<span class="gp">In [20]: </span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span>
<span class="gr">Out[20]: </span><span class="n">dtype</span><span class="p">(</span><span class="s">&#39;float64&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Any object in Python can and in general does have a number of attributes that are accessed in just the way demonstrated above, with a period and the attribute name following the name of the particular object.  In general, attributes involve properties of the object that are stored by Python with the object and require no computation.   Python just looks up the attribute and returns its value.</p>
<p>Objects in Python also have associated with them a number of specialized functions called <em>methods</em> that act on the object.  In contrast to attributes, methods generally involve Python performing some kind of computation.  Methods are accessed in a fashion similar to attributes, by appending a period followed the method&#8217;s name, which is followed by a pair of open-close parentheses, consistent with methods being a kind of function that acts on the object.  Often methods are used with no arguments, as methods by default act on the object whose name they follow.  In some cases. however, methods can take arguments.  Examples of methods for NumPy arrays are sorting, calculating the mean, or standard deviation of the array.  The code below illustrates a few array methods.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [21]: </span><span class="n">a</span>
<span class="go">Out[21]:</span>
<span class="go">array([ 0.859057  ,  0.27228037,  0.87780026,  0.14341207,</span>
<span class="go">        0.05067356,  0.83490135,  0.54844515,  0.33583966,</span>
<span class="go">        0.31527767,  0.15868803])</span>

<span class="gp">In [22]: </span><span class="n">a</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>                <span class="c"># sum</span>
<span class="gr">Out[22]: </span><span class="mf">4.3963751104791005</span>

<span class="gp">In [23]: </span><span class="n">a</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>               <span class="c"># mean or average</span>
<span class="gr">Out[23]: </span><span class="mf">0.43963751104791005</span>

<span class="gp">In [24]: </span><span class="n">a</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>                <span class="c"># variance</span>
<span class="gr">Out[24]: </span><span class="mf">0.090819477333711512</span>

<span class="gp">In [25]: </span><span class="n">a</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>                <span class="c"># standard deviation</span>
<span class="gr">Out[25]: </span><span class="mf">0.30136270063448711</span>

<span class="gp">In [26]: </span><span class="n">a</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>               <span class="c"># sort small to large</span>

<span class="gp">In [27]: </span><span class="n">a</span>
<span class="go">Out[27]:</span>
<span class="go">array([ 0.05067356,  0.14341207,  0.15868803,  0.27228037,</span>
<span class="go">        0.31527767,  0.33583966,  0.54844515,  0.83490135,</span>
<span class="go">        0.859057  ,  0.87780026])</span>

<span class="gp">In [28]: </span><span class="n">a</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="go">Out[29]:</span>
<span class="go">array([ 0.3       ,  0.3       ,  0.3       ,  0.3       ,</span>
<span class="go">        0.31527767,  0.33583966,  0.54844515,  0.8       ,</span>
<span class="go">        0.8       ,  0.8       ])</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">clip()</span></tt> method provides an example of a method that takes an argument, in this case the arguments are the lower and upper values to which array elements are cutoff if their values are outside the range set by these values.</p>
</div>
<div class="section" id="example-linear-least-squares-fitting">
<span id="linfitfunc"></span><span id="index-7"></span><h2>7.3. Example: linear least squares fitting<a class="headerlink" href="#example-linear-least-squares-fitting" title="Permalink to this headline">¶</a></h2>
<p>In this section we illustrate how to use functions and methods in the context of modeling experimental data.</p>
<p>In science and engineering we often have some theoretical curve or <em>fitting function</em> that we would like to fit to some experimental data.  In general, the fitting function is of the form <img class="math" src="../_images/math/f2a94a3c878991eee73ffab4cd86e49578dfcff0.png" alt="f(x; a, b, c, ...)"/>, where <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> is the independent variable and <img class="math" src="../_images/math/7dd2a5ea01fbd72ad2a58dd1f3d6ecbfde6208a1.png" alt="a"/>, <img class="math" src="../_images/math/5e87bf41a96deddf6cb485ff530f153f2590e9cc.png" alt="b"/>, <img class="math" src="../_images/math/65868d23a5bfe5b3b2d819386b19c14fa36af134.png" alt="c"/>, ... are parameters to be adjusted so that the function <img class="math" src="../_images/math/f2a94a3c878991eee73ffab4cd86e49578dfcff0.png" alt="f(x; a, b, c, ...)"/> best fits the experimental data.  For example, suppose we had some data of the velocity <em>vs</em> time for a falling mass.  If the mass falls only a short distance such that its velocity remains well below its terminal velocity, we can ignore air resistance.  In this case, we expect the acceleration to be constant and the velocity to change linearly in time according to the equation</p>
<div class="math" id="equation-eq:veltime">
<p><span class="eqno">(1)</span><img src="../_images/math/a5e07e99e42c4858fac5982f9e6befa62580cf91.png" alt="v(t) = v_{0} - g t \;,"/></p>
</div><p>where <img class="math" src="../_images/math/67f4714f065d485540ad40829e0717bf75e9dd85.png" alt="g"/> is the local gravitational acceleration.  We can fit the data graphically, say by plotting it as shown below in Fig. <a class="reference internal" href="#fig-fallingmassdataplot"><em>4.6</em></a> and then drawing a line through the data.  When we draw a straight line through a data, we try to minimize the distance between the points and the line, globally averaged over the whole data set.</p>
<div class="figure align-center" id="fig-fallingmassdataplot">
<a class="reference internal image-reference" href="../_images/VelocityVsTimePlot.png"><img alt="Velocity *vs* time for falling mass." src="../_images/VelocityVsTimePlot.png" style="width: 640.0px; height: 480.0px;" /></a>
<p class="caption">Velocity <em>vs</em> time for falling mass.</p>
</div>
<p>While this can give a reasonable estimate of the best fit to the data, the procedure is rather <em>ad hoc</em>.  We would prefer to have a more well-defined analytical method for determining what constitutes a &#8220;best fit&#8221;.  One way to do that is to consider the sum</p>
<div class="math" id="equation-eq:lsqrsum">
<p><span class="eqno">(2)</span><img src="../_images/math/a8573f999e1d6d08d3e997e968301b92ff48660d.png" alt="S = \sum_{i}^{n} [y_{i} - f(x_{i}; a, b, c, ...)]^2 \;,"/></p>
</div><p>where <img class="math" src="../_images/math/483447aeb715ae59fa6c201bab757353a6e5eef1.png" alt="y_{i}"/> and <img class="math" src="../_images/math/ee86b9368004471938e199c1af46351509c36a9f.png" alt="f(x_{i}; a, b, c, ...)"/> are the values of the experimental data and the fitting function, respectively, at <img class="math" src="../_images/math/c223a5391d7bfd7e7c68274c104fc7418944376e.png" alt="x_{i}"/>, and <img class="math" src="../_images/math/11a85f3c69ae6702cb1d99d3de451913b8f84c04.png" alt="S"/> is the square of their difference summed over all <img class="math" src="../_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/> data points.  The quantity <img class="math" src="../_images/math/11a85f3c69ae6702cb1d99d3de451913b8f84c04.png" alt="S"/> is a sort of global measure of how much the the fit <img class="math" src="../_images/math/ee86b9368004471938e199c1af46351509c36a9f.png" alt="f(x_{i}; a, b, c, ...)"/> differs from the experimental data <img class="math" src="../_images/math/483447aeb715ae59fa6c201bab757353a6e5eef1.png" alt="y_{i}"/>.</p>
<p>Notice that for a given set of data points <img class="math" src="../_images/math/e2efbd378c8fe3dddbd1b92a6c50ce836cdfa256.png" alt="\{x_i, y_i\}"/>, <img class="math" src="../_images/math/11a85f3c69ae6702cb1d99d3de451913b8f84c04.png" alt="S"/> is a function only of the fitting parameters <img class="math" src="../_images/math/c2ac372309690954372b2a07d25879eca6e7182e.png" alt="a, b, ..."/>, that is, <img class="math" src="../_images/math/60e63d079ab6f3a72448c04abd575ae4e331c189.png" alt="S=S(a, b, c, ...)"/>.  One way of defining a <em>best</em> fit, then, is to find the values of the fitting parameters <img class="math" src="../_images/math/c2ac372309690954372b2a07d25879eca6e7182e.png" alt="a, b, ..."/> that minimize the <img class="math" src="../_images/math/11a85f3c69ae6702cb1d99d3de451913b8f84c04.png" alt="S"/>.</p>
<p>In principle, finding the values of the fitting parameters <img class="math" src="../_images/math/c2ac372309690954372b2a07d25879eca6e7182e.png" alt="a, b, ..."/> that minimize the <img class="math" src="../_images/math/11a85f3c69ae6702cb1d99d3de451913b8f84c04.png" alt="S"/> is a simple matter.  Just set the partial derivatives of <img class="math" src="../_images/math/11a85f3c69ae6702cb1d99d3de451913b8f84c04.png" alt="S"/> with respect to the fitting parameter equal to zero and solve the resulting system of equations:</p>
<div class="math" id="equation-eq:sysSzero">
<p><span class="eqno">(3)</span><img src="../_images/math/edd2832f6e99009976fe09dd9172ec62466db405.png" alt="\frac{\partial S}{\partial a} = 0 \;, \quad
\frac{\partial S}{\partial b} = 0 \;, ..."/></p>
</div><p>Because there are as many equations as there are fitting paramters, we should be able to solve the system of equations and find the values of the fitting parameters that minimize <img class="math" src="../_images/math/11a85f3c69ae6702cb1d99d3de451913b8f84c04.png" alt="S"/>.  Solving those systems of equations is straightforward if the fitting function <img class="math" src="../_images/math/e0c6ededd533689fa67d52d6669b06efc105084e.png" alt="f(x; a, b, ...)"/> is linear in the fitting parameters.  Some examples of fitting functions linear in the fitting parameters are:</p>
<div class="math" id="equation-eq:fitfuncs">
<p><span class="eqno">(4)</span><img src="../_images/math/f9f4915a04ca4bc146c9ce13c3b8600bd54514a8.png" alt="f(x; a, b) &amp;= a + bx \\
f(x; a, b, c) &amp;= a + bx + cx^2 \\
f(x; a, b, c) &amp;= a \sin x + b e^x + c e^{-x^2} \;."/></p>
</div><p>For fitting functions such as these, taking the partial derivatives with respect to the fitting parameters, as proposed in <a href="#equation-eq:sysSzero">(3)</a>, results in a set of algebraic equations that are linear in the fitting paramters <img class="math" src="../_images/math/c2ac372309690954372b2a07d25879eca6e7182e.png" alt="a, b, ..."/> Because they are linear, these equations can be solved in a straightforward manner.</p>
<p>For cases in which the fitting function is not linear in the fitting parameters, one can generally still find the values of the fitting parameters that minimize <img class="math" src="../_images/math/11a85f3c69ae6702cb1d99d3de451913b8f84c04.png" alt="S"/> but finding them requires more work, which goes beyond our immediate interests here.</p>
<div class="section" id="linear-regression">
<h3>7.3.1. Linear regression<a class="headerlink" href="#linear-regression" title="Permalink to this headline">¶</a></h3>
<p>We start by considering the simplest case, fitting a straight line to a data set, such as the one shown in Fig. <a class="reference internal" href="#fig-fallingmassdataplot"><em>4.6</em></a> above.  Here the fitting function is <img class="math" src="../_images/math/e1528c0d4ea1a9258d12be199a0fe5bef87bd6b7.png" alt="f(x) = a + bx"/>, which is linear in the fitting parameters <img class="math" src="../_images/math/7dd2a5ea01fbd72ad2a58dd1f3d6ecbfde6208a1.png" alt="a"/> and <img class="math" src="../_images/math/5e87bf41a96deddf6cb485ff530f153f2590e9cc.png" alt="b"/>.  For a straight line, the sum in <a href="#equation-eq:lsqrsum">(2)</a> becomes</p>
<div class="math" id="equation-eq:linreg1">
<p><span class="eqno">(5)</span><img src="../_images/math/467c4ba8d96c24ceca0f04e90b668abb6dfeba44.png" alt="S(a,b) = \sum_{i} (y_{i} - a - bx_{i})^2 \;."/></p>
</div><p>Finding the best fit in this case corresponds to finding the values of the fitting parameters <img class="math" src="../_images/math/7dd2a5ea01fbd72ad2a58dd1f3d6ecbfde6208a1.png" alt="a"/> and <img class="math" src="../_images/math/5e87bf41a96deddf6cb485ff530f153f2590e9cc.png" alt="b"/> for which <img class="math" src="../_images/math/05447d6f01b083afbd02655b08a608fba7180a41.png" alt="S(a,b)"/> is a minimum.  To find the minimum, we set the derivatives of <img class="math" src="../_images/math/05447d6f01b083afbd02655b08a608fba7180a41.png" alt="S(a,b)"/> equal to zero:</p>
<div class="math" id="equation-eq:linreg2">
<p><span class="eqno">(6)</span><img src="../_images/math/2d2e583a2b9d062811a59572545b03450bdb01fb.png" alt="\frac{\partial S}{\partial a} &amp;= \sum_{i}-2(y_{i}-a-bx_{i}) = 2 \left(na + b\sum_{i}x_{i} - \sum_{i}y_{i} \right) = 0 \\
\frac{\partial S}{\partial b} &amp;= \sum_{i}-2(y_{i}-a-bx_{i})\,x_{i} = 2 \left(a\sum_{i}x_{i} + b\sum_{i}x_{i}^2 - \sum_{i}x_{i}y_{i} \right) = 0"/></p>
</div><p>Dividing both equations by <img class="math" src="../_images/math/d21790ee4259a72b655b00bfa761aaa3727ff1f6.png" alt="2n"/> leads to the equations</p>
<div class="math" id="equation-eq:ablinreg">
<p><span class="eqno">(7)</span><img src="../_images/math/b4e2abf1772d509119be01b57f716a98c9ac3b3d.png" alt="a + b\bar{x} &amp;= \bar{y}\\
a\bar{x} + b\frac{1}{n}\sum_{i}x_{i}^2  &amp;=  \frac{1}{n}\sum_{i}x_{i}y_{i}"/></p>
</div><p>where</p>
<div class="math" id="equation-eq:linreg3">
<p><span class="eqno">(8)</span><img src="../_images/math/c57d193768472a9b0cb7fe9c5909a1ce765bc260.png" alt="\bar{x} &amp;= \frac{1}{n}\sum_{i}x_{i}\\
\bar{y} &amp;= \frac{1}{n}\sum_{i}y_{i}\;."/></p>
</div><p>Solving Eq. <a href="#equation-eq:ablinreg">(7)</a> for the fitting parameters gives</p>
<div class="math" id="equation-eq:b1">
<p><span class="eqno">(9)</span><img src="../_images/math/ec6d0307e3b40db069bde9184391b4613a071c17.png" alt="b &amp;= \frac{\sum_{i}x_{i}y_{i} - n\bar{x}\bar{y}} {\sum_{i}x_{i}^2 - n \bar{x}^2}\\
a &amp;= \bar{y} - b\bar{x} \;."/></p>
</div><p>Noting that <img class="math" src="../_images/math/a73d59716bf104cba1857230136b3688ca4908fa.png" alt="n\bar{y}=\sum_{i}y"/> and <img class="math" src="../_images/math/b936ddd63c2eefbcd42dfcc90f5062044d017692.png" alt="n\bar{x}=\sum_{i}x"/>, the results can be written as</p>
<div class="math" id="equation-eq:b2">
<p><span class="eqno">(10)</span><img src="../_images/math/41c9e3a1640ecf16c9ea6d3622480a80ef536ea5.png" alt="b &amp;= \frac{\sum_{i}(x_{i}- \bar{x})\,y_{i}} {\sum_{i}(x_{i}- \bar{x})\,x_{i}} \\
a &amp;= \bar{y} - b\bar{x} \;."/></p>
</div><p>While Eqs. <a href="#equation-eq:b1">(9)</a> and <a href="#equation-eq:b2">(10)</a> are equivalent analytically, Eq. <a href="#equation-eq:b2">(10)</a> is preferred for numerical calculations because Eq. <a href="#equation-eq:b2">(10)</a> is less sensitive to roundoff errors.  Here is a Python function implementing this algorithm:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">def</span> <span class="nf">LineFit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Returns slope and y-intercept of linear fit to (x,y)</span>
<span class="sd">    data set&#39;&#39;&#39;</span>
    <span class="n">xavg</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">xavg</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">xavg</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">yint</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">-</span><span class="n">slope</span><span class="o">*</span><span class="n">xavg</span>
    <span class="k">return</span> <span class="n">slope</span><span class="p">,</span> <span class="n">yint</span>
</pre></div>
</td></tr></table></div>
<p>It&#8217;s hard to imagine a simpler implementation of the linear regression algorithm.</p>
</div>
<div class="section" id="linear-regression-with-weighting">
<span id="index-8"></span><h3>7.3.2. Linear regression with weighting: <img class="math" src="../_images/math/8bd0685e3bf9101859d24cf0e851651f182364c9.png" alt="\chi^2"/><a class="headerlink" href="#linear-regression-with-weighting" title="Permalink to this headline">¶</a></h3>
<p>The linear regression routine of the previous section weights all data points equally.  That is fine if the absolute uncertainty is the same for all data points.  In many cases, however, the uncertainty is different for different points in a data set.  In such cases, we would like to weight the data that has smaller uncertainty more heavily than those data that have greater uncertainty.  For this case, there is a standard method of weighting and fitting data that is known as <img class="math" src="../_images/math/8bd0685e3bf9101859d24cf0e851651f182364c9.png" alt="\chi^2"/>  (or <em>chi-squared</em>) fitting.  In this method we suppose that associated with each <img class="math" src="../_images/math/de95ed6d6e2afa0ab5dcc6342114b2c8c78d5eff.png" alt="(x_{i},y_{i})"/> data point is an uncertainty in the value of <img class="math" src="../_images/math/483447aeb715ae59fa6c201bab757353a6e5eef1.png" alt="y_{i}"/> of <img class="math" src="../_images/math/9c8c31099f876e6f9f1bd9d48b5b0ab5c0bbd9cb.png" alt="\pm\sigma_{i}"/>.  In this case, the &#8220;best fit&#8221; is defined as the the one with the set of fitting parameters that minimizes the sum</p>
<div class="math" id="equation-eq:chisq">
<p><span class="eqno">(11)</span><img src="../_images/math/d556f55617f3357e1e550187dc5418e65af922f0.png" alt="\chi^2 = \sum_{i} \left(\frac{y_{i} - f(x_{i})} {\sigma_{i}}\right)^2 \;."/></p>
</div><p>Setting the uncertainties <img class="math" src="../_images/math/48c329833a2cfba61eeb61c1dbea45561555732d.png" alt="\sigma_{i}=1"/> for all data points yields the same sum <img class="math" src="../_images/math/11a85f3c69ae6702cb1d99d3de451913b8f84c04.png" alt="S"/> we introduced in the previous section.  In this case, all data points are weighted equally.  However, if <img class="math" src="../_images/math/34b6e12495bc3e5cf60b81e2e200071104b114e2.png" alt="\sigma_{i}"/> varies from point to point, it is clear that those points with large <img class="math" src="../_images/math/34b6e12495bc3e5cf60b81e2e200071104b114e2.png" alt="\sigma_{i}"/> contribute less to the sum than those with small <img class="math" src="../_images/math/34b6e12495bc3e5cf60b81e2e200071104b114e2.png" alt="\sigma_{i}"/>.  Thus, data points with large <img class="math" src="../_images/math/34b6e12495bc3e5cf60b81e2e200071104b114e2.png" alt="\sigma_{i}"/> are weighted less than those with small <img class="math" src="../_images/math/34b6e12495bc3e5cf60b81e2e200071104b114e2.png" alt="\sigma_{i}"/>.</p>
<p>To fit data to a straight line, we set <img class="math" src="../_images/math/e1528c0d4ea1a9258d12be199a0fe5bef87bd6b7.png" alt="f(x) = a + bx"/> and write</p>
<div class="math" id="equation-eq:chisqlin">
<p><span class="eqno">(12)</span><img src="../_images/math/525da88044c7b2562b4adc2170853a895b40eb60.png" alt="\chi^2(a,b) = \sum_{i} \left(\frac{y_{i} - a -bx_{i}} {\sigma_{i}}\right)^2 \;."/></p>
</div><p>Finding the minimum for <img class="math" src="../_images/math/fe6bcd5b8e10d406115af23c155605d3429fc4b4.png" alt="\chi^2(a,b)"/> follows the same procedure used for finding the minimum of <img class="math" src="../_images/math/05447d6f01b083afbd02655b08a608fba7180a41.png" alt="S(a,b)"/> in the previous section.  The result is</p>
<div class="math" id="equation-eq:abwchisq">
<p><span class="eqno">(13)</span><img src="../_images/math/573993a2f929f08ef775f8759f814d1c99d1b0b7.png" alt="b &amp;= \frac{\sum_{i}(x_{i} - \hat{x})\,y_{i}/\sigma_{i}^2} {\sum_{i}(x_{i} - \hat{x})\,x_{i}/\sigma_{i}^2}\\
a &amp;= \hat{y} - b\hat{x} \;."/></p>
</div><p>where</p>
<div class="math" id="equation-eq:xychisq">
<p><span class="eqno">(14)</span><img src="../_images/math/1fe03b964a3a779f4f30e9f4ccebd847fafa64d3.png" alt="\hat{x} &amp;= \frac{\sum_{i}x_{i}/\sigma_{i}^2} {\sum_{i}1/\sigma_{i}^2}\\
\hat{y} &amp;= \frac{\sum_{i}y_{i}/\sigma_{i}^2} {\sum_{i}1/\sigma_{i}^2}\;."/></p>
</div><p>For a fit to a straight line, the overall quality of the fit can be measured by the reduced chi-squared parameter</p>
<div class="math" id="equation-:eq:linreg13">
<p><span class="eqno">(15)</span><img src="../_images/math/89b14396c9675a7cc2e7e2294dbccc702cb35747.png" alt="\chi_{r}^2 = \frac{\chi^2}{n-2}"/></p>
</div><p>where <img class="math" src="../_images/math/8bd0685e3bf9101859d24cf0e851651f182364c9.png" alt="\chi^2"/> is given by Eq. <a href="#equation-eq:chisq">(11)</a> evaluated at the optimal values of <img class="math" src="../_images/math/7dd2a5ea01fbd72ad2a58dd1f3d6ecbfde6208a1.png" alt="a"/> and <img class="math" src="../_images/math/5e87bf41a96deddf6cb485ff530f153f2590e9cc.png" alt="b"/> given by Eq. <a href="#equation-eq:abwchisq">(13)</a>.  A good fit is characterized by <img class="math" src="../_images/math/bb5453675e0b64be4859d0952f03a4c8206e1fbe.png" alt="\chi_{r}^2 \approx 1"/>.  This makes sense because if the uncertainties <img class="math" src="../_images/math/34b6e12495bc3e5cf60b81e2e200071104b114e2.png" alt="\sigma_{i}"/> have been properly estimated, then <img class="math" src="../_images/math/271d2f2af6ca101c091de5bf01eac1ee22944641.png" alt="[y_{i}-f(x_{i})]^2"/> should on average be roughly equal to <img class="math" src="../_images/math/7159a2fd029aed8d1f024a0a2ccab7d8deb1745c.png" alt="\sigma_{i}^2"/>, so that the sum in Eq. <a href="#equation-eq:chisq">(11)</a> should consist of <img class="math" src="../_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/> terms approximately equal to 1.  Of course, if there were only 2 terms (<cite>n=2</cite>), then <img class="math" src="../_images/math/8bd0685e3bf9101859d24cf0e851651f182364c9.png" alt="\chi^2"/> would be zero as the best straight line fit to two points is a perfect fit.  That is essentially why <img class="math" src="../_images/math/c7a63a6e0ac8e2e58a7d321f0ad1294592eb533e.png" alt="\chi_{r}^2"/> is normalized using <img class="math" src="../_images/math/573f1dbd55f7a60f53088d2ebc1c19b6d9d20e29.png" alt="n-2"/> instead of <img class="math" src="../_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/>.  If <img class="math" src="../_images/math/c7a63a6e0ac8e2e58a7d321f0ad1294592eb533e.png" alt="\chi_{r}^2"/> is significantly greater than 1, this indicates a poor fit to the fitting function (or an underestimation of the uncertainties <img class="math" src="../_images/math/34b6e12495bc3e5cf60b81e2e200071104b114e2.png" alt="\sigma_{i}"/>).  If <img class="math" src="../_images/math/c7a63a6e0ac8e2e58a7d321f0ad1294592eb533e.png" alt="\chi_{r}^2"/> is significantly less than 1, then it indicates that the uncertainties were probably overestimated (the fit and fitting function may or may not be good).</p>
<div class="figure align-center" id="fig-linregerrbars">
<a class="reference internal image-reference" href="../_images/VelocityVsTimeFit.png"><img alt="Least square linear." src="../_images/VelocityVsTimeFit.png" style="width: 640.0px; height: 480.0px;" /></a>
<p class="caption">Fit using <img class="math" src="../_images/math/8bd0685e3bf9101859d24cf0e851651f182364c9.png" alt="\chi^2"/> least squares fitting routine with data weighted by error bars.</p>
</div>
<p>We can also get estimates of the uncertainties in our determination of the fitting parameters <img class="math" src="../_images/math/7dd2a5ea01fbd72ad2a58dd1f3d6ecbfde6208a1.png" alt="a"/> and <img class="math" src="../_images/math/5e87bf41a96deddf6cb485ff530f153f2590e9cc.png" alt="b"/>, although deriving the formulas is a bit more involved that we want to get into here.  Therefore, we just give the results:</p>
<div class="math" id="equation-eq:absigma">
<p><span class="eqno">(16)</span><img src="../_images/math/bdce6645585e8363bf7f9eec0c09af5bcf012030.png" alt="\sigma_{b}^2 &amp;= \frac{1} {\sum_{i}(x_{i} - \hat{x})\,x_{i}/\sigma_{i}^2}\\
\sigma_{a}^2 &amp;= \sigma_{b}^2 \frac{\sum_{i}x_{i}^2/\sigma_{i}^2} {\sum_{i}1/\sigma_{i}^2}\;."/></p>
</div><p>The estimates of uncertainties in the fitting parameters depend explicitly on <img class="math" src="../_images/math/51104887a06dbbd7a10d79ee5083f3557e7dbbc8.png" alt="\{\sigma_{i}\}"/> and will only be meaningful if (<em>i</em>) <img class="math" src="../_images/math/bb5453675e0b64be4859d0952f03a4c8206e1fbe.png" alt="\chi_{r}^2 \approx 1"/> and (<em>ii</em>) the estimates of the uncertainties <img class="math" src="../_images/math/34b6e12495bc3e5cf60b81e2e200071104b114e2.png" alt="\sigma_{i}"/> are accurate.</p>
<p>You can find more information, including a derivation of Eq. <a href="#equation-eq:absigma">(16)</a>, in <em>Data Reduction and Error Analysis for the Physical Sciences, 3rd ed</em> by P. R. Bevington &amp; D. K. Robinson, McGraw-Hill, New York, 2003.</p>
</div>
</div>
<div class="section" id="anonymous-functions-lambda">
<span id="lambda"></span><span id="index-9"></span><h2>7.4. Anonymous functions (lambda)<a class="headerlink" href="#anonymous-functions-lambda" title="Permalink to this headline">¶</a></h2>
<p>Python provides another way to generate functions called <em>lambda</em> expressions.  A lambda expression is a kind of in-line function that can be generated on the fly to accomplish some small task.  You can assign lambda functions a name, but you don&#8217;t need to; hence, they are often called <em>anonymous</em> functions.  A lambda uses the keyword <tt class="docutils literal"><span class="pre">lambda</span></tt> and has the general form</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="go">lambda arg1, arg2, ... : output</span>
</pre></div>
</div>
<p>The arguments <tt class="docutils literal"><span class="pre">arg1,</span> <span class="pre">arg2,</span> <span class="pre">...</span></tt> are inputs to a lambda, just as for a functions, and the output is an expression using the arguments.</p>
<p>While lambda expressions need not be named, we illustrate their use by comparing a conventional Python function definition to a lambda expression to which we give a name.  First, we define a conventional python function</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="gp">   ...:</span>     <span class="k">return</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span>

<span class="gp">In [2]: </span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gr">Out[2]: </span><span class="mi">15</span>
</pre></div>
</div>
<p>Next, we define a lambda that does the same thing</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [3]: </span><span class="n">g</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="p">:</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span>

<span class="gp">In [4]: </span><span class="n">g</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gr">Out[4]: </span><span class="mi">15</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">lambda</span></tt> defined by <tt class="docutils literal"><span class="pre">g</span></tt> does the same thing as the function <tt class="docutils literal"><span class="pre">f</span></tt>.  Such <tt class="docutils literal"><span class="pre">lambda</span></tt> expressions are useful when you need a very short function definition, usually to be used locally only once or a few times.</p>
<p>Sometimes lambda expressions are used in function arguments that call for a function <em>name</em>, as opposed to the function itself.  Moreover, in cases where a the function to be integrated is already defined but is a function one independent variable and several parameters, the lambda expression can be a convenient way of fashioning a single variable function.  Don&#8217;t worry if this doesn&#8217;t quite make sense to you right now.  You will see examples of lambda expressions used in just this way in the section <a class="reference internal" href="../chap9/chap9_scipy.html#numericalintegration"><em>Numerical integration</em></a>.</p>
<p>There are also a number of nifty programming tricks that can be implemented using <tt class="docutils literal"><span class="pre">lambda</span></tt> expressions, but we will not go into them here.  Look up <tt class="docutils literal"><span class="pre">lambdas</span></tt> on the web if you are curious about their more exotic uses.</p>
</div>
<div class="section" id="exercises">
<h2>7.5. Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Write a function that can return each of the first three spherical Bessel functions <img class="math" src="../_images/math/60920a3e4ac1fbd43861a70732f011d929b2e6d6.png" alt="j_n(x)"/>:</p>
<div class="math" id="equation-eq:bessel">
<p><span class="eqno">(17)</span><img src="../_images/math/94faa32462734815bf6fbc2e1ed6e82f970a3659.png" alt="j_0(x) &amp;= \frac{\sin x}{x}\\
j_1(x) &amp;= \frac{\sin x}{x^2} - \frac{\cos x}{x}\\
j_2(x) &amp;= \left(\frac{3}{x^2}-1\right)\frac{\sin x}{x} - \frac{3\cos x}{x^2}"/></p>
</div><p>Your function should take as arguments a NumPy array <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> and the order <img class="math" src="../_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/>, and should return an array of the designated order <img class="math" src="../_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/> spherical Bessel function.  Take care to make sure that your functions behave properly at <img class="math" src="../_images/math/55ba271999995cac02cf578362df5be030594ed6.png" alt="x=0"/>.</p>
<p>Demonstrate the use of your function by writing a Python routine that plots the three Bessel functions for <img class="math" src="../_images/math/deaacbaef89361cbea0275ac5ffacd2231a6cd2f.png" alt="0 \le x \le 20"/>.  Your plot should look like the one below.  Something to think about: You might note that <img class="math" src="../_images/math/f510737f5578276ab654e12d3f494035bc0111f3.png" alt="j_1(x)"/> can be written in terms of <img class="math" src="../_images/math/c56a234aed9abff3d3bfa19bec05efa9697cba48.png" alt="j_0(x)"/>, and that <img class="math" src="../_images/math/0048e8c4de2b5626ea993049193d06b73ff37b9b.png" alt="j_2(x)"/> can be written in terms of <img class="math" src="../_images/math/f510737f5578276ab654e12d3f494035bc0111f3.png" alt="j_1(x)"/> and <img class="math" src="../_images/math/c56a234aed9abff3d3bfa19bec05efa9697cba48.png" alt="j_0(x)"/>.  Can you take advantage of this to write a more efficient function for the calculations of <img class="math" src="../_images/math/f510737f5578276ab654e12d3f494035bc0111f3.png" alt="j_1(x)"/> and <img class="math" src="../_images/math/0048e8c4de2b5626ea993049193d06b73ff37b9b.png" alt="j_2(x)"/>?</p>
<div class="figure align-center" id="fig-besselsph">
<a class="reference internal image-reference" href="../_images/besselSph.png"><img alt="Spherical Bessel functions." src="../_images/besselSph.png" style="width: 640.0px; height: 480.0px;" /></a>
</div>
</li>
<li><ol class="first loweralpha simple">
<li>Write a function that simulates the rolling of <img class="math" src="../_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/> dice.  Use the NumPy function <tt class="docutils literal"><span class="pre">random.random_integers(6)</span></tt>, which generates a random integer between 1 and 6 with equal probability (like rolling fair dice).  The input of your function should be the number of dice thrown each roll and the output should be the sum of the <img class="math" src="../_images/math/413f8a8e40062a9090d9d50b88bc7b551b314c26.png" alt="n"/> dice.</li>
<li>&#8220;Roll&#8221; 2 dice 10,000 times keeping track of all the sums of each set of rolls in a list.  Then use your program to generate a histogram  summarizing the rolls of two dice 10,000 times.  The result should look like the histogram plotted below.  Use the MatPlotLib function <tt class="docutils literal"><span class="pre">hist</span></tt> (see <a class="reference external" href="http://matplotlib.org/api/pyplot_summary.html">http://matplotlib.org/api/pyplot_summary.html</a>) and set the number of bins in the histogram equal to the number of different possible outcomes of a roll of your dice.  For example, the sum of two dice can be anything between 2 and 12, which corresponds to 11 possible outcomes.  You should get a histogram that looks like the one below.</li>
<li>&#8220;Repeat part (b) using 3 dice and plot the resulting histogram.</li>
</ol>
<div class="figure align-center" id="fig-dicerolln">
<a class="reference internal image-reference" href="../_images/diceRoll2.png"><img alt="Rolling dice." src="../_images/diceRoll2.png" style="width: 640.0px; height: 480.0px;" /></a>
</div>
</li>
<li><p class="first">Write a function to draw a circular smiley face with eyes, a nose, and a mouth.  One argument should set the overall size of the face (the circle radius).  Optional arguments should allow the user to specify the <img class="math" src="../_images/math/5f81ea407dc24031569231ab2cd28222176f38ca.png" alt="(x,y)"/> position of the face, whether the face is smiling or frowning, and the color of the lines.  The default should be a smiling blue face centered at <img class="math" src="../_images/math/57db89fefe471ad3a78a81a65482f4fa79a3cfc9.png" alt="(0,0)"/>.  Once you write your function, write a program that calls it several times to produce a plot like the one below (creative improvisation is encouraged!).  In producing your plot, you may find the call <tt class="docutils literal"><span class="pre">plt.axes().set_aspect(1)</span></tt> useful so that circles appear as circles and not ovals.  You should only use MatPlotLib functions introduced in this text.  To create a circle you can create an array of angles that goes from 0 to <img class="math" src="../_images/math/9871bd64995368def3d10c85692a233e4cb5e3f9.png" alt="2\pi"/> and then produce the <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> and <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> arrays for your circle by taking the cosine and sine, respectively, of the array.  Hint: You can use the same <img class="math" src="../_images/math/5f81ea407dc24031569231ab2cd28222176f38ca.png" alt="(x,y)"/> arrays to make the smile and frown as you used to make the circle by plotting appropriate slices of those arrays.  You do not need to create new arrays.</p>
<div class="figure align-center" id="fig-faces">
<a class="reference internal image-reference" href="../_images/smiley.png"><img alt="Faces." src="../_images/smiley.png" style="width: 640.0px; height: 480.0px;" /></a>
</div>
</li>
<li><p class="first">In the section <a class="reference internal" href="#linfitfunc"><em>Example: linear least squares fitting</em></a>, we showed that the best fit of a line <img class="math" src="../_images/math/c7ac4a56a69d067a93b1c2c6a4646cc2bee027f2.png" alt="y = a + bx"/> to a set of data <img class="math" src="../_images/math/efcb32524312579e1629e6402e026315f2d88056.png" alt="\{(x_i,y_i)\}"/> is obtained for the values of <img class="math" src="../_images/math/7dd2a5ea01fbd72ad2a58dd1f3d6ecbfde6208a1.png" alt="a"/> and <img class="math" src="../_images/math/5e87bf41a96deddf6cb485ff530f153f2590e9cc.png" alt="b"/> given by Eq. <a href="#equation-eq:b2">(10)</a>.  Those formulas were obtained by finding the values of <img class="math" src="../_images/math/7dd2a5ea01fbd72ad2a58dd1f3d6ecbfde6208a1.png" alt="a"/> and <img class="math" src="../_images/math/5e87bf41a96deddf6cb485ff530f153f2590e9cc.png" alt="b"/> that minimized the sum in Eq. <a href="#equation-eq:linreg1">(5)</a>. This approach and these formulas are valid when the uncertainties in the data are the same for all data points.  The Python function <tt class="docutils literal"><span class="pre">LineFit(x,</span> <span class="pre">y)</span></tt> in the section <a class="reference internal" href="#linfitfunc"><em>Example: linear least squares fitting</em></a> implements Eq. <a href="#equation-eq:b2">(10)</a>.</p>
<ol class="loweralpha">
<li><p class="first">Write a new fitting function <tt class="docutils literal"><span class="pre">LineFitWt(x,</span> <span class="pre">y)</span></tt> that implements the formulas given in Eq. <a href="#equation-eq:xychisq">(14)</a> that minimize the <img class="math" src="../_images/math/8bd0685e3bf9101859d24cf0e851651f182364c9.png" alt="\chi^2"/> function give by Eq. <a href="#equation-eq:chisqlin">(12)</a>.  This more general approach is valid when the individual data points have different weightings <em>or</em> when they all have the same weighting.  You should also write a function to calculate the reduced chi-squared <img class="math" src="../_images/math/407382c743eb2fdc299a9e2e8dec8863afa187eb.png" alt="\chi_r^2"/> defined by Eq. <a href="#equation-eq:chisqlin">(12)</a>.</p>
</li>
<li><p class="first">Write a Python program that reads in the data below, plots it, and fits it using the two fitting functions  <tt class="docutils literal"><span class="pre">LineFit(x,</span> <span class="pre">y)</span></tt> and <tt class="docutils literal"><span class="pre">LineFitWt(x,</span> <span class="pre">y)</span></tt>.  Your program should plot the data with error bars and with <em>both</em> fits with and without weighting, that is from <tt class="docutils literal"><span class="pre">LineFit(x,</span> <span class="pre">y)</span></tt> and <tt class="docutils literal"><span class="pre">LineFitWt(x,</span> <span class="pre">y,</span> <span class="pre">dy)</span></tt>.  It should also report the results for both fits on the plot, similar to the output of the supplied program above, as well as the values of <img class="math" src="../_images/math/407382c743eb2fdc299a9e2e8dec8863afa187eb.png" alt="\chi_r^2"/>, the reduce chi-squared value, for both fits.  Explain why weighting the data gives a steeper or less steep slope than the fit without weighting.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre>Velocity vs time data
for a falling mass
time (s)   velocity (m/s)   uncertainty (m/s)
  2.23          139               16
  4.78          123               16
  7.21          115                4
  9.37           96                9
 11.64           62               17
 14.23           54               17
 16.55           10               12
 18.70           -3               15
 21.05          -13               18
 23.21          -55               10
</pre></div>
</td></tr></table></div>
</li>
</ol>
</li>
<li><p class="first">Modify the function <tt class="docutils literal"><span class="pre">LineFitWt(x,</span> <span class="pre">y)</span></tt> you wrote in Exercise 4 above so that in addition to returning the fitting parameters <img class="math" src="../_images/math/7dd2a5ea01fbd72ad2a58dd1f3d6ecbfde6208a1.png" alt="a"/> and <img class="math" src="../_images/math/5e87bf41a96deddf6cb485ff530f153f2590e9cc.png" alt="b"/>, it also returns the uncertainties in the fitting parameters <img class="math" src="../_images/math/ebd11fac03b10ab06ab0af037ac8baac8f2fbf61.png" alt="\sigma_a"/> and <img class="math" src="../_images/math/b20af9e5c620d57a31b28d5683082fc16c6f5828.png" alt="\sigma_b"/> using the formulas given by Eq. <a href="#equation-eq:absigma">(16)</a>.  Use your new fitting function to find the uncertainties in the fitted slope and <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/>-intercept for the data provided with Exercise 4.</p>
</li>
</ol>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../chap1/chap1_intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap2/chap2_basics.html">2. Launching Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap3/chap3_arrays.html">3. Strings, Lists, Arrays, and Dictionaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap4/chap4_io.html">4. Input and Output</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap5/chap5_plot.html">5. Plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap6/chap6_loopsconds.html">6. Conditionals and Loops</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">7. Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#user-defined-functions">7.1. User-defined functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#methods-and-attributes">7.2. Methods and attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-linear-least-squares-fitting">7.3. Example: linear least squares fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#anonymous-functions-lambda">7.4. Anonymous functions (lambda)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exercises">7.5. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chap8/chap8_fitting.html">8. Curve Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap9/chap9_scipy.html">9. Numerical Routines: SciPy and NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apdx1/apdx1_install.html">10. Installing Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apdx2/apdx2_ipynb.html">11. IPython Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apdx3/apdx3_resources.html">12. Python Resources</a></li>
</ul>

          <h3 style="margin-top: 1.5em;">Search</h3>
          <form class="search" action="../search.html" method="get">
            <input type="text" name="q" />
            <input type="submit" value="Go" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
          <p class="searchtip" style="font-size: 90%">
            Enter search terms or a module, class or function name.
          </p>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <a href="../chap6/chap6_loopsconds.html" title="6. Conditionals and Loops"
             >previous</a> |
          <a href="../chap8/chap8_fitting.html" title="8. Curve Fitting"
             >next</a> |
          <a href="../genindex.html" title="General Index"
             >index</a>
            <br/>
            <a href="../_sources/chap7/chap7_funcs.txt"
               rel="nofollow">Show Source</a>
        </div>

        <div class="right">
          
    <div class="footer">
        &copy; Copyright 2014, David J. Pine.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>