<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>5. Plotting &mdash; PyMan 0.9.30 documentation</title>
    
    <link rel="stylesheet" href="../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.30',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="PyMan 0.9.30 documentation" href="../index.html" />
    <link rel="next" title="6. Conditionals and Loops" href="../chap6/chap6_loopsconds.html" />
    <link rel="prev" title="4. Input and Output" href="../chap4/chap4_io.html" /> 
  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
        <div class="headertitle"><a
          href="../pymanMaster.html">PyMan 0.9.30 documentation</a></div>
        <div class="rel">
          <a href="../chap4/chap4_io.html" title="4. Input and Output"
             accesskey="P">previous</a> |
          <a href="../chap6/chap6_loopsconds.html" title="6. Conditionals and Loops"
             accesskey="N">next</a> |
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="plotting">
<span id="chap5"></span><h1>5. Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¶</a></h1>
<p id="index-0">The graphical representation of data&#8212;plotting&#8212;is one of the most important tools for evaluating and understanding scientific data and theoretical predictions.  However, plotting is not a part of core Python but is provided through one of several possible library modules.  The most highly developed and widely used plotting package for Python is MatPlotLib (<a class="reference external" href="http://MatPlotLib.sourceforge.net/">http://MatPlotLib.sourceforge.net/</a>).  It is a powerful and flexible program that has become the <em>de facto</em> standard for 2-d plotting with Python.</p>
<p>Because MatPlotLib is an external library&#8212;in fact it&#8217;s a collection of libraries&#8212;it must be imported into any routine that uses it.  MatPlotLib makes extensive use of NumPy so the two should be imported together.  Therefore, for any program for which you would like to produce 2-d plots, you should include the lines</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<p>There are other MatPlotLib sub-libraries, but the <tt class="docutils literal"><span class="pre">pyplot</span></tt> library provides nearly everything that you need for 2-d plotting.  The standard prefix for it is <tt class="docutils literal"><span class="pre">plt</span></tt>.  The two statements above must appear before any calls to NumPy or MatPlotLib routines are made.  MatPlotLib is automatically loaded with the IPython shell so you do not need to use import matplotlib.pyplot nor do you need to use the <tt class="docutils literal"><span class="pre">plt</span></tt> prefix when working in the IPython shell.</p>
<p>One final word before we get started: We only scratch the surface of what is possible using MatPlotLib and as you become familiar with it, you will surely want to do more than this manual describes.  In that case, you need to go the the web to get more information.  A good place to start is <a class="reference external" href="http://matplotlib.org/api/pyplot_summary.html">http://matplotlib.org/api/pyplot_summary.html</a>.  Another interesting web page is <a class="reference external" href="http://matplotlib.org/gallery.html">http://matplotlib.org/gallery.html</a>.</p>
<div class="section" id="an-interactive-session-with-pyplot">
<h2>5.1. An interactive session with <tt class="docutils literal"><span class="pre">pyplot</span></tt><a class="headerlink" href="#an-interactive-session-with-pyplot" title="Permalink to this headline">¶</a></h2>
<p id="index-1">We begin with an interactive plotting session that illustrates some very basic features of MatPlotLib.  Type in the <tt class="docutils literal"><span class="pre">plot</span></tt> command shown below and press the return key.  Take care to follow the exact syntax.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gr">Out[1]: </span><span class="p">[</span><span class="o">&lt;</span><span class="n">MatPlotLib</span><span class="o">.</span><span class="n">lines</span><span class="o">.</span><span class="n">Line2D</span> <span class="n">at</span> <span class="mh">0x94e1310</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
</div>
<div class="figure align-center" id="fig-zigzagplotdemo">
<a class="reference internal image-reference" href="../_images/zigzagPlotDemo.png"><img alt="Interactive plot window" src="../_images/zigzagPlotDemo.png" style="width: 640.0px; height: 480.0px;" /></a>
<p class="caption">Interactive plot window</p>
</div>
<p>A window should appear with a plot that looks something like the <a class="reference internal" href="#fig-zigzagplotdemo"><em>Interactive plot window</em></a> shown here.  By default, the <tt class="docutils literal"><span class="pre">plot</span></tt> function draws a line between the data points that were entered.  You can save this plot to an image file by clicking on the floppy disk icon at the top of the plot window.  You can also zoom, pan, scroll through the plot, and return to the original view using the other icons in the plot window.  Experimenting with them reveals their functions.</p>
<p>When you are finished, be sure to close the plot window.</p>
<p>Let&#8217;s take a closer look at the <tt class="docutils literal"><span class="pre">plot</span></tt> function.  It is used to plot <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/>-<img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> data sets and is written like this</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">x</span></tt> and <tt class="docutils literal"><span class="pre">y</span></tt> are arrays (or lists) that have the same size.  If the <tt class="docutils literal"><span class="pre">x</span></tt> array is missing, that is, if there is only a single array, as in our example above, the <tt class="docutils literal"><span class="pre">plot</span></tt> function uses <tt class="docutils literal"><span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">...,</span> <span class="pre">N-1</span></tt> for the <tt class="docutils literal"><span class="pre">x</span></tt> array, where <tt class="docutils literal"><span class="pre">N</span></tt> is the size of the <tt class="docutils literal"><span class="pre">y</span></tt> array.  Thus, the <tt class="docutils literal"><span class="pre">plot</span></tt> function provides a quick graphical way of examining a data set.</p>
<p>More typically, you supply both an <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> and a <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> data set to plot.  Taking things a bit further, you may also want to plot several data sets on the same graph, use symbols as well as lines, label the axes, create a title and a legend, and control the color of symbols and lines.  All of this is possible but requires calling a number of plotting functions.  For this reason, plotting is usually done using a Python script or program.</p>
</div>
<div class="section" id="basic-plotting">
<span id="chap5basicplotting"></span><h2>5.2. Basic plotting<a class="headerlink" href="#basic-plotting" title="Permalink to this headline">¶</a></h2>
<p id="index-2">The quickest way to learn how to plot using the MatPlotLib library is by example.  For our first task, let&#8217;s plot the sine function over the interval from 0 to <img class="math" src="../_images/math/68f0a8f80ca0cffa13635d762ef5046571f05d9b.png" alt="4\pi"/>.  The main plotting function <tt class="docutils literal"><span class="pre">plot</span></tt> in MatPlotLib does not plot functions <em>per se</em>, it plots <img class="math" src="../_images/math/5f81ea407dc24031569231ab2cd28222176f38ca.png" alt="(x,y)"/> data points.  As we shall see, we can instruct the function <tt class="docutils literal"><span class="pre">plot</span></tt> either to just draw point&#8212;or dots&#8212;at each data point, or we can instruct it to draw straight lines between the data points.  To create the illusion of the smooth function that the sine function is, we need to create enough <img class="math" src="../_images/math/5f81ea407dc24031569231ab2cd28222176f38ca.png" alt="(x,y)"/> data points so that when <tt class="docutils literal"><span class="pre">plot</span></tt> draws straight lines between the data points, the function appears to be smooth.  The sine function undergoes two full oscillations with two maxima and two minima between 0 and <img class="math" src="../_images/math/68f0a8f80ca0cffa13635d762ef5046571f05d9b.png" alt="4\pi"/>.  So let&#8217;s start by creating an array with 33 data points between 0 and <img class="math" src="../_images/math/68f0a8f80ca0cffa13635d762ef5046571f05d9b.png" alt="4\pi"/>, and then let MatPlotLib draw a straight line between them.  Our code consists of four parts</p>
<ul class="simple">
<li>import the NumPy and MatPlotLib modules (lines 1-2 below)</li>
<li>create the <img class="math" src="../_images/math/5f81ea407dc24031569231ab2cd28222176f38ca.png" alt="(x,y)"/> data arrays (lines 3-4 below)</li>
<li>have <tt class="docutils literal"><span class="pre">plot</span></tt> draw straight lines between the <img class="math" src="../_images/math/5f81ea407dc24031569231ab2cd28222176f38ca.png" alt="(x,y)"/> data points (line 5 below)</li>
<li>display the plot in a figure window using the <tt class="docutils literal"><span class="pre">show</span></tt> function (line 6 below)</li>
</ul>
<p>Here is our code, which consists of only 6 lines:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">33</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center" id="fig-sineplot">
<a class="reference internal image-reference" href="../_images/sinePlot.png"><img alt="Sine function" src="../_images/sinePlot.png" style="width: 560.0px; height: 420.0px;" /></a>
<p class="caption">Sine function</p>
</div>
<p>Only 6 lines suffice to create the plot, which consists of the sine function over the interval from 0 to <img class="math" src="../_images/math/68f0a8f80ca0cffa13635d762ef5046571f05d9b.png" alt="4\pi"/>, as advertised, as well as axes annotated with nice whole numbers over the appropriate interval.  It&#8217;s a pretty nice plot made with very little code.</p>
<p>One problem, however, is that while the plot oscillates like a sine wave, it is not smooth.  This is because we did not create the <img class="math" src="../_images/math/5f81ea407dc24031569231ab2cd28222176f38ca.png" alt="(x,y)"/> arrays with enough data points.  To correct this, we need more data points.  The plot below was created using the same program shown above but with 129 <img class="math" src="../_images/math/5f81ea407dc24031569231ab2cd28222176f38ca.png" alt="(x,y)"/> data points instead of 33.  Try it out your self by copying the above program and replacing 33 in line 3 with 129 so that the function <tt class="docutils literal"><span class="pre">linspace</span></tt> creates an array with 129 data points instead of 33.</p>
<div class="figure align-center" id="fig-sineplotdenserxy">
<a class="reference internal image-reference" href="../_images/sinePlotDenserXY.png"><img alt="Sine function with more data points" src="../_images/sinePlotDenserXY.png" style="width: 560.0px; height: 420.0px;" /></a>
<p class="caption">Sine function plotted using more data points</p>
</div>
<p>The code above illustrates how plots can be made with very little code using the MatPlotLib module.  In making this plot, MatPlotLib has made a number of choices, such as the size of the figure, the blue color of the line, even the fact that by default a line is drawn between successive data points in the <img class="math" src="../_images/math/5f81ea407dc24031569231ab2cd28222176f38ca.png" alt="(x,y)"/> arrays.  All of these choices can be changed by explicitly instructing MatPlotLib to do so.  This involves including more arguments in the function calls we have used and using new functions that control other properties of the plot.  The next example illustrates a few of the simpler embellishments that are possible.</p>
<p>In the <a class="reference internal" href="#fig-wavypulse"><em>Wavy pulse</em></a> figure, we plot two <img class="math" src="../_images/math/5f81ea407dc24031569231ab2cd28222176f38ca.png" alt="(x,y)"/> data sets: a smooth line curve and some data represented by red circles.  In this plot, we label the <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> and <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> axes, create a legend, and draw lines to indicate where <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> and <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> are zero.  The code that creates this plot is shown below.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="c"># read data from file</span>
<span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">&#39;wavePulseData.txt&#39;</span><span class="p">,</span> <span class="n">unpack</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c"># create x and y arrays for theory</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mf">5.0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c"># create plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;theory&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="s">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;transverse displacement&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;upper right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#39;gray&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#39;gray&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="c"># save plot to file</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;WavyPulse.pdf&#39;</span><span class="p">)</span>

<span class="c"># display plot on screen</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<div class="figure align-center" id="fig-wavypulse">
<a class="reference internal image-reference" href="../_images/WavyPulse.png"><img alt="Wavy pulse" src="../_images/WavyPulse.png" style="width: 480.0px; height: 320.0px;" /></a>
<p class="caption">Wavy pulse</p>
</div>
<p>If you have read the first four chapters, the code in lines 1-9 in the above script should  be familiar to you.  Fist, the script loads the NumPy and MatPlotLib modules, then reads data from a data file into two arrays, <tt class="docutils literal"><span class="pre">xdata</span></tt> and <tt class="docutils literal"><span class="pre">ydata</span></tt>, and then creates two more arrays, <tt class="docutils literal"><span class="pre">x</span></tt> and <tt class="docutils literal"><span class="pre">y</span></tt>.  The first pair or arrays, <tt class="docutils literal"><span class="pre">xdata</span></tt> and <tt class="docutils literal"><span class="pre">ydata</span></tt>, contain the <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/>-<img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> data that are plotted as red circles in the <a class="reference internal" href="#fig-wavypulse"><em>Wavy pulse</em></a> figure; the arrays created in line 8 and 9 contain the <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/>-<img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> data that are plotted as a blue line.</p>
<p>The functions that do the plotting begin on line 12.  Let&#8217;s go through them one by one and see what they do.  You will notice in several cases that <em>keyword arguments</em> (<tt class="docutils literal"><span class="pre">kwargs</span></tt>) are used in several cases.  Keyword arguments are <em>optional</em> arguments that have the form <tt class="docutils literal"><span class="pre">kwarg=</span></tt> <em>data</em>, where <em>data</em> might be a number, a string, a tuple, or some other form of data.</p>
<blockquote>
<div><dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">figure()</span></tt></dt>
<dd>creates a blank figure window.  If it has no arguments, it creates a window that is 8 inches wide and 6 inches high by default, although the size that appears on your computer depends on your screen&#8217;s resolution.  For most computers, it will be much smaller.  You can create a window whose size differs from the default using the optional keyword argument <tt class="docutils literal"><span class="pre">figsize</span></tt>, as we have done here.  If you use <tt class="docutils literal"><span class="pre">figsize</span></tt>, set it equal to a 2-element tuple where the elements are the width and height, respectively, of the plot.  Multiple calls to <tt class="docutils literal"><span class="pre">figure()</span></tt> opens multiple windows:  <tt class="docutils literal"><span class="pre">figure(1)</span></tt> opens up one window for plotting, <tt class="docutils literal"><span class="pre">figure(2)</span></tt> another, and <tt class="docutils literal"><span class="pre">figure(3)</span></tt> yet another.</dd>
<dt><tt class="docutils literal"><span class="pre">plot(x,</span> <span class="pre">y,</span></tt> <em>optional arguments</em> <tt class="docutils literal"><span class="pre">)</span></tt></dt>
<dd>graphs the <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/>-<img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> data in the arrays <tt class="docutils literal"><span class="pre">x</span></tt> and <tt class="docutils literal"><span class="pre">y</span></tt>.  The third argument is a format string that specifies the color and the type of line or symbol that is used to plot the data.  The string <tt class="docutils literal"><span class="pre">'ro'</span></tt> specifies a red (<tt class="docutils literal"><span class="pre">r</span></tt>) circle (<tt class="docutils literal"><span class="pre">o</span></tt>).  The string <tt class="docutils literal"><span class="pre">'b-'</span></tt> specifies a blue (<tt class="docutils literal"><span class="pre">b</span></tt>) solid line (<tt class="docutils literal"><span class="pre">-</span></tt>).  The keyword argument <tt class="docutils literal"><span class="pre">label</span></tt> is set equal to a string that labels the data if the <tt class="docutils literal"><span class="pre">legend</span></tt> function is called subsequently.</dd>
<dt><tt class="docutils literal"><span class="pre">xlabel(</span></tt> <em>string</em> <tt class="docutils literal"><span class="pre">)</span></tt></dt>
<dd>takes a string argument that specifies the label for the graph&#8217;s <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/>-axis.</dd>
<dt><tt class="docutils literal"><span class="pre">ylabel(</span></tt> <em>string</em> <tt class="docutils literal"><span class="pre">)</span></tt></dt>
<dd>takes a string argument that specifies the label for the graph&#8217;s <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/>-axis.</dd>
<dt><tt class="docutils literal"><span class="pre">legend()</span></tt></dt>
<dd>makes a legend for the data plotted.  Each <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/>-<img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> data set is labeled  using the string that was supplied by the <tt class="docutils literal"><span class="pre">label</span></tt> keyword in the <tt class="docutils literal"><span class="pre">plot</span></tt> function that graphed the data set.  The <tt class="docutils literal"><span class="pre">loc</span></tt> keyword argument specifies the location of the legend.</dd>
<dt><tt class="docutils literal"><span class="pre">axhline()</span></tt></dt>
<dd>draws a horizontal line across the width of the plot at <tt class="docutils literal"><span class="pre">y=0</span></tt>.  The optional keyword argument <tt class="docutils literal"><span class="pre">color</span></tt> is a string that specifies the color of the line.  The default color is black.  The optional keyword argument <tt class="docutils literal"><span class="pre">zorder</span></tt> is an integer that specifies which plotting elements are in front of or behind others.  By default, new plotting elements appear <em>on top of</em> previously plotted elements and have a value of <tt class="docutils literal"><span class="pre">zorder=0</span></tt>.  By specifying <tt class="docutils literal"><span class="pre">zorder=-1</span></tt>, the horizontal line is plotted <em>behind</em> all existing plot elements that have not be assigned an explicit <tt class="docutils literal"><span class="pre">zorder</span></tt> less than -1.</dd>
<dt><tt class="docutils literal"><span class="pre">axvline()</span></tt></dt>
<dd>draws a vertical line from the top to the bottom of the plot at <tt class="docutils literal"><span class="pre">x=0</span></tt>.  See <tt class="docutils literal"><span class="pre">axhline()</span></tt> for explanation of the arguments.</dd>
<dt><tt class="docutils literal"><span class="pre">savefig(</span></tt> <em>string</em> <tt class="docutils literal"><span class="pre">)</span></tt></dt>
<dd>saves the figure to data data file with a name specified by the string argument.  The string argument can also contain path information if you want to save the file so some place other than the default directory.</dd>
<dt><tt class="docutils literal"><span class="pre">show()</span></tt></dt>
<dd>displays the plot on the computer screen.  No screen output is produced before this function is called.</dd>
</dl>
</div></blockquote>
<p id="index-3">To plot the solid blue line, the code uses the <tt class="docutils literal"><span class="pre">'b-'</span></tt> format specifier in the <tt class="docutils literal"><span class="pre">plot</span></tt> function call.  It is important to understand that MatPlotLib draws <em>straight lines</em> between data points.  Therefore, the curve will appear smooth only if the data in the NumPy arrays are sufficiently dense.  If the space between data points is too large, the straight lines the <tt class="docutils literal"><span class="pre">plot</span></tt> function draws between data points will be visible.  For plotting a typical function, something on the order of 100-200 data points usually produces a smooth curve, depending on just how curvy the function is.  On the other hand, only two points are required to draw a smooth straight line.</p>
<p>Detailed information about the MatPlotLib plotting functions are available online, starting with the site <a class="reference external" href="http://matplotlib.org/api/pyplot_summary.html">http://matplotlib.org/api/pyplot_summary.html</a>.  The main MatPlotLib site is <a class="reference external" href="http://matplotlib.org/">http://matplotlib.org/</a>.</p>
<div class="section" id="specifying-line-and-symbol-types-and-colors">
<h3>5.2.1. Specifying line and symbol types and colors<a class="headerlink" href="#specifying-line-and-symbol-types-and-colors" title="Permalink to this headline">¶</a></h3>
<p>In the above example, we illustrated how to draw one line type (solid), one symbol type (circle), and two colors (blue and red).  There are many more possibilities, which are specified in the tables below.  The way it works is to specify a string consisting of one or more plotting format specifiers.  There are two types of format specifiers, one for the line or symbol type and another for the color.  It does not matter in which order the  format specifiers are listed in the string.  Examples are given following the two tables.  Try them out to make sure you understand how these plotting format specifiers work.</p>
<p id="index-4">The first table below shows the characters used to specify the line or symbol type that is used.  If a line type is chosen, the lines are drawn between the data points.  If a marker type is chosen, the a marker is plotted at each data point.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="34%" />
<col width="16%" />
<col width="34%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">character</th>
<th class="head">description</th>
<th class="head">character</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">-</span></tt></td>
<td>solid line style</td>
<td><tt class="docutils literal"><span class="pre">3</span></tt></td>
<td>tri_left marker</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">--</span></tt></td>
<td>dashed line style</td>
<td><tt class="docutils literal"><span class="pre">4</span></tt></td>
<td>tri_right marker</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">-.</span></tt></td>
<td>dash-dot line style</td>
<td><tt class="docutils literal"><span class="pre">s</span></tt></td>
<td>square marker</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">:</span></tt></td>
<td>dotted line style</td>
<td><tt class="docutils literal"><span class="pre">p</span></tt></td>
<td>pentagon marker</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">.</span></tt></td>
<td>point marker</td>
<td><tt class="docutils literal"><span class="pre">*</span></tt></td>
<td>star marker</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">,</span></tt></td>
<td>pixel marker</td>
<td><tt class="docutils literal"><span class="pre">h</span></tt></td>
<td>hexagon1 marker</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">o</span></tt></td>
<td>circle marker</td>
<td><tt class="docutils literal"><span class="pre">H</span></tt></td>
<td>hexagon2 marker</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">v</span></tt></td>
<td>triangle_down marker</td>
<td><tt class="docutils literal"><span class="pre">+</span></tt></td>
<td>plus marker</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">^</span></tt></td>
<td>triangle_up marker</td>
<td><tt class="docutils literal"><span class="pre">x</span></tt></td>
<td>x marker</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">&lt;</span></tt></td>
<td>triangle_left marker</td>
<td><tt class="docutils literal"><span class="pre">D</span></tt></td>
<td>diamond marker</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">&gt;</span></tt></td>
<td>triangle_right marker</td>
<td><tt class="docutils literal"><span class="pre">d</span></tt></td>
<td>thin_diamond marker</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">1</span></tt></td>
<td>tri_down marker</td>
<td><tt class="docutils literal"><span class="pre">|</span></tt></td>
<td>vline marker</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">2</span></tt></td>
<td>tri_up marker</td>
<td><tt class="docutils literal"><span class="pre">_</span></tt></td>
<td>hline marker</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>This second table gives the character codes for eight different colors.  Many more are possible but the color specification becomes more complex. You can consult the web-based MatPlotLib documentation for further details.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="55%" />
<col width="45%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">character</th>
<th class="head">color</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">b</span></tt></td>
<td>blue</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">g</span></tt></td>
<td>green</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">r</span></tt></td>
<td>red</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">c</span></tt></td>
<td>cyan</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">m</span></tt></td>
<td>magenta</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">y</span></tt></td>
<td>yellow</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">k</span></tt></td>
<td>black</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">w</span></tt></td>
<td>white</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Here are some examples of how these format specifiers can be used:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&#39;ro&#39;</span><span class="p">)</span>    <span class="c"># plots red circles</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&#39;ks-&#39;</span><span class="p">)</span>   <span class="c"># plot black squares connected by black lines</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&#39;g^&#39;</span><span class="p">)</span>    <span class="c"># plots green triangles that point up</span>

<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&#39;k-&#39;</span><span class="p">)</span>    <span class="c"># plots a black line between the points</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&#39;ms&#39;</span><span class="p">)</span>    <span class="c"># plots magenta squares</span>
</pre></div>
</div>
<p>You can also make two calls sequentially for added versatility.  For example, by sequentially calling the last two plot calls, the plot produces magenta squares on top of black lines connecting the data points.</p>
<p>These format specifiers give rudimentary control of the plotting symbols and lines.  MatPlotLib provides much more precise and detailed control of the plotting symbol size, line types, and colors using optional keyword arguments instead of the plotting format strings introduced above.  For example, the following command creates a plot of large yellow diamond symbols with blue edges connected by a green dashed line:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">&#39;d&#39;</span><span class="p">,</span>
     <span class="n">markerfacecolor</span><span class="o">=</span><span class="s">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span>
     <span class="n">markeredgecolor</span><span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Try it out!  The online MatPlotLib documentation provides all the plotting format keyword arguments and their possible values.</p>
</div>
<div class="section" id="error-bars">
<h3>5.2.2. Error bars<a class="headerlink" href="#error-bars" title="Permalink to this headline">¶</a></h3>
<p id="index-5">When plotting experimental data it is customary to include error bars that indicate graphically the degree of uncertainty that exists in the measurement of each data point.  The MatPlotLib function <tt class="docutils literal"><span class="pre">errorbar</span></tt> plots data with error bars attached.  It can be used in a way that either replaces or augments the <tt class="docutils literal"><span class="pre">plot</span></tt> function.  Both vertical and horizontal error bars can be displayed.  The figure below illustrates the use of error bars.</p>
<div class="figure align-center" id="fig-expdecay">
<a class="reference internal image-reference" href="../_images/ExpDecay.png"><img alt="Error Bars" src="../_images/ExpDecay.png" style="width: 450.0px; height: 300.0px;" /></a>
<p class="caption">Error Bars</p>
</div>
<p>When error bars are desired, you typically replace the <tt class="docutils literal"><span class="pre">plot</span></tt> function with the <tt class="docutils literal"><span class="pre">errorbar</span></tt> function.  The first two arguments of the  <tt class="docutils literal"><span class="pre">errorbar</span></tt> function are the <tt class="docutils literal"><span class="pre">x</span></tt> and <tt class="docutils literal"><span class="pre">y</span></tt> arrays to be plotted, just as for the <tt class="docutils literal"><span class="pre">plot</span></tt> function.  The keyword <tt class="docutils literal"><span class="pre">fmt</span></tt> <em>must be used</em> to specify the format of the points to be plotted; the format specifiers are the same as for <tt class="docutils literal"><span class="pre">plot</span></tt>.  The keywords <tt class="docutils literal"><span class="pre">xerr</span></tt> and <tt class="docutils literal"><span class="pre">yerr</span></tt> are used to specify the <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> and <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> error bars.  Setting one or both of them to a constant specifies one size for all the error bars.  Alternatively, setting one or both of them equal to an array that has the same length as the <tt class="docutils literal"><span class="pre">x</span></tt> and <tt class="docutils literal"><span class="pre">y</span></tt> arrays allows you to give each data point an error bar with a different value.  If you only want <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> error bars, then you should only specify the <tt class="docutils literal"><span class="pre">yerr</span></tt> keyword and omit the <tt class="docutils literal"><span class="pre">xerr</span></tt> keyword.  The color of the error bars is set with the keyword <tt class="docutils literal"><span class="pre">ecolor</span></tt>.</p>
<p>The code and plot below illustrates how to make error bars and was used to make the above plot.  Lines 14 and 15 contain the call to the <tt class="docutils literal"><span class="pre">errorbar</span></tt> function.  The <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> error bars are all set to a constant value of 0.75, meaning that the error bars extend 0.75 to the left and 0.75 to the right of each data point.  The <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> error bars are set equal to an array, which was read in from the data file containing the data to be plotted, so each data point has a different <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> error bar.  By the way, leaving out the <tt class="docutils literal"><span class="pre">xerr</span></tt> keyword argument in the <tt class="docutils literal"><span class="pre">errorbar</span></tt> function call below would mean that only the <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> error bars would be plotted.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="c"># read data from file</span>
<span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">yerror</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">&#39;expDecayData.txt&#39;</span><span class="p">,</span> <span class="n">unpack</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c"># create theoretical fitting curve</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mf">1.1</span><span class="o">+</span> <span class="mf">3.0</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mf">10.0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c"># create plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;theory&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;data&quot;</span><span class="p">,</span>
             <span class="n">xerr</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">yerror</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;transverse displacement&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;upper right&#39;</span><span class="p">)</span>

<span class="c"># save plot to file</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;ExpDecay.pdf&#39;</span><span class="p">)</span>

<span class="c"># display plot on screen</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>We have more to say about the <tt class="docutils literal"><span class="pre">errorbar</span></tt> function in the sections on  logarithmic plots.  But the brief introduction given here should suffice for making most plots not involving logarithmic axes.</p>
</div>
<div class="section" id="setting-plotting-limits-and-excluding-data">
<h3>5.2.3. Setting plotting limits and excluding data<a class="headerlink" href="#setting-plotting-limits-and-excluding-data" title="Permalink to this headline">¶</a></h3>
<p>It turns out that you often want to restrict the range of numerical values over which you plot data or functions.  In these cases you may need to manually specify the plotting window or, alternatively, you may wish to exclude data points that are outside some set of limits.  Here we demonstrate methods for doing this.</p>
<div class="section" id="setting-plotting-limits">
<h4>5.2.3.1. Setting plotting limits<a class="headerlink" href="#setting-plotting-limits" title="Permalink to this headline">¶</a></h4>
<p id="index-6">Suppose you want to plot the tangent function over the interval from 0 to 10.  The following script offers an straightforward first attempt.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">)</span>
<span class="n">ytan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">ytan</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="figure align-center" id="fig-plotlimits1">
<a class="reference internal image-reference" href="../_images/plotLimits1.png"><img alt="tangent theta" src="../_images/plotLimits1.png" style="width: 640.0px; height: 480.0px;" /></a>
</div>
<p>The resulting plot, shown above, doesn&#8217;t quite look like what you might have expected for <img class="math" src="../_images/math/03317095d80476c4ecca47a9004927ed8672e7a7.png" alt="\tan\theta"/> <em>vs</em> <img class="math" src="../_images/math/a9cfbeb8ebee1f365919e147a79e242dcb67ee5d.png" alt="\theta"/>.  The problem is that <img class="math" src="../_images/math/03317095d80476c4ecca47a9004927ed8672e7a7.png" alt="\tan\theta"/> diverges at <img class="math" src="../_images/math/ca0d8907fc01e261e1172bca684a0bcd5546866f.png" alt="\theta = \pi/2, 3\pi/2, 5\pi/2, ..."/>, which leads to large spikes in the plots as values in the <tt class="docutils literal"><span class="pre">theta</span></tt> array come near those values.  Of course, we don&#8217;t want the plot to extend all the way out to <img class="math" src="../_images/math/9e0d43547af6ade3b647231a5b32a0ce3cd9bbcf.png" alt="\pm\infty"/> in the <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> direction, nor can it.  Instead, we would like the plot to extend far enough that we get the idea of what is going on as <img class="math" src="../_images/math/5eac46bb4b6383353911a54999480e4f7298282d.png" alt="y\rightarrow\pm\infty"/>, but we would still like to see the behavior of the graph near <img class="math" src="../_images/math/c99c34dbd3d8e874a8ea4cc301e3b8ff9abcea59.png" alt="y=0"/>.  We can restrict the range of <tt class="docutils literal"><span class="pre">ytan</span></tt> values that are plotted using the MatPlotLib function <tt class="docutils literal"><span class="pre">ylim</span></tt>, as we demonstrate in the script below.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">)</span>
<span class="n">ytan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">ytan</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>         <span class="c"># restricts range of y axis from -8 to +8</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The figure produced by this script is shown below.  The plot now looks much more like the familiar <img class="math" src="../_images/math/03317095d80476c4ecca47a9004927ed8672e7a7.png" alt="\tan\theta"/> function we know.  We have also include a call to the <tt class="docutils literal"><span class="pre">axline</span></tt> function to create an <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> axis.</p>
<div class="figure align-center" id="fig-plotlimits2">
<a class="reference internal image-reference" href="../_images/plotLimits2.png"><img alt="tangent theta" src="../_images/plotLimits2.png" style="width: 640.0px; height: 480.0px;" /></a>
<p class="caption">Tangent function (with spurious lines)</p>
</div>
<p>The vertical blue lines at <img class="math" src="../_images/math/e4d1f6e4a1de9f64d5deed88c9f71482e3198731.png" alt="\theta = \pi/2, 3\pi/2, 5\pi/2"/> should not appear in a plot of <img class="math" src="../_images/math/03317095d80476c4ecca47a9004927ed8672e7a7.png" alt="\tan\theta"/> <em>vs</em> <img class="math" src="../_images/math/a9cfbeb8ebee1f365919e147a79e242dcb67ee5d.png" alt="\theta"/>.  However, they do appear because the <tt class="docutils literal"><span class="pre">plot</span></tt> function simply draws lines between the data points in the <tt class="docutils literal"><span class="pre">x</span></tt>-<tt class="docutils literal"><span class="pre">y</span></tt> arrays provided in its arguments.  Thus, <tt class="docutils literal"><span class="pre">plot</span></tt> draws a line between the very large positive and negative <tt class="docutils literal"><span class="pre">ytan</span></tt> values corresponding to the <tt class="docutils literal"><span class="pre">theta</span></tt> values on either side of <img class="math" src="../_images/math/eb290bb4fbda29c280354df1325e092fc682e865.png" alt="\pi/2"/> where <img class="math" src="../_images/math/03317095d80476c4ecca47a9004927ed8672e7a7.png" alt="\tan\theta"/> diverges to <img class="math" src="../_images/math/9e0d43547af6ade3b647231a5b32a0ce3cd9bbcf.png" alt="\pm\infty"/>.  It would be nice to exclude that line.</p>
</div>
<div class="section" id="masked-arrays">
<h4>5.2.3.2. Masked arrays<a class="headerlink" href="#masked-arrays" title="Permalink to this headline">¶</a></h4>
<p id="index-7">We can exclude the data points near <img class="math" src="../_images/math/e4d1f6e4a1de9f64d5deed88c9f71482e3198731.png" alt="\theta = \pi/2, 3\pi/2, 5\pi/2"/> in the above plot, and thus avoid drawing the nearly vertical lines at those points, using NumPy&#8217;s <em>masked array</em> feature.  The code below shows how this is done and produces the graph below.  The masked array feature is implemented in line 6 with a call to NumPy&#8217;s <tt class="docutils literal"><span class="pre">masked_where</span></tt> function in the sub-module <tt class="docutils literal"><span class="pre">ma</span></tt> (masked array).  Therefore, it is called by writing <tt class="docutils literal"><span class="pre">np.ma.masked_where</span></tt>.  The <tt class="docutils literal"><span class="pre">masked_where</span></tt> function works as follows.  The first argument sets the condition for masking elements of the array, which is specified by the second argument.  In this case, the function says to mask all elements of the array <tt class="docutils literal"><span class="pre">ytan</span></tt> (the second argument) where the absolute value of <tt class="docutils literal"><span class="pre">ytan</span></tt> is greater than 20.  The result is set equal to <tt class="docutils literal"><span class="pre">ytanM</span></tt>.  When <tt class="docutils literal"><span class="pre">ytanM</span></tt> is plotted, MatPlotLib&#8217;s <tt class="docutils literal"><span class="pre">plot</span></tt> function omits all masked points from the plot.  You can think of it as the <tt class="docutils literal"><span class="pre">plot</span></tt> function lifting the pen that is drawing the line in the plot when it comes to the masked points in the array <tt class="docutils literal"><span class="pre">ytanM</span></tt>.</p>
<div class="figure align-center" id="fig-plotlimits3">
<a class="reference internal image-reference" href="../_images/plotLimits3.png"><img alt="tangent theta" src="../_images/plotLimits3.png" style="width: 640.0px; height: 480.0px;" /></a>
<p class="caption">Tangent function</p>
</div>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">)</span>
<span class="n">ytan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">ytanM</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ytan</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">20.</span><span class="p">,</span> <span class="n">ytan</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">ytanM</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="subplots">
<h3>5.2.4. Subplots<a class="headerlink" href="#subplots" title="Permalink to this headline">¶</a></h3>
<p id="index-8">Often you want to create two or more graphs and place them next to one another, generally because they are related to each other in some way.  The plot below shows an example of such a plot.  In the top graph, <img class="math" src="../_images/math/03317095d80476c4ecca47a9004927ed8672e7a7.png" alt="\tan\theta"/> and <img class="math" src="../_images/math/02759ccf65b36d5b9e7c0b3a634e3f76fce0be18.png" alt="\sqrt{(8/\theta)^2-1}"/> <em>vs</em> <img class="math" src="../_images/math/a9cfbeb8ebee1f365919e147a79e242dcb67ee5d.png" alt="\theta"/> are plotted.  The two curves cross each other at the points where <img class="math" src="../_images/math/2f07722216f7aa2ad6a8e5b896bea85382a8523e.png" alt="\tan\theta=\sqrt{(8/\theta)^2-1}"/>.  In the bottom  <img class="math" src="../_images/math/d7f0a662f0514815599f1d64af426699da78a1d7.png" alt="\cot\theta"/> and <img class="math" src="../_images/math/2d54fe2752d18671cc5372ea4091afe53999893e.png" alt="-\sqrt{(8/\theta)^2-1}"/> <em>vs</em> <img class="math" src="../_images/math/a9cfbeb8ebee1f365919e147a79e242dcb67ee5d.png" alt="\theta"/> are plotted.  These two curves cross each other at the points where <img class="math" src="../_images/math/5e42f5e2b4f16484d6ad9bdc0d78bc7b3cf81de7.png" alt="\cot\theta=-\sqrt{(8/\theta)^2-1}"/>.</p>
<div class="figure align-center" id="fig-subplotdemo">
<a class="reference internal image-reference" href="../_images/subplotDemo.png"><img alt="Crossing functions" src="../_images/subplotDemo.png" style="width: 720.0px; height: 540.0px;" /></a>
<p class="caption">Crossing functions</p>
</div>
<p>The code that produces this plot is provided below.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">8.</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mf">8.</span><span class="o">/</span><span class="n">theta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mf">1.</span><span class="p">)</span>
<span class="n">ytan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">ytan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ytan</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">20.</span><span class="p">,</span> <span class="n">ytan</span><span class="p">)</span>
<span class="n">ycot</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">ycot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ycot</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">20.</span><span class="p">,</span> <span class="n">ycot</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">ytan</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">3.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">5.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;theta&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;tan(theta)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="o">-</span><span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">ycot</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&quot;gray&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">&#39;--&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&quot;theta&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&quot;cot(theta)&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>The function  <tt class="docutils literal"><span class="pre">subplot</span></tt>, called on lines 13 and 24, creates the two subplots in the above figure.   <tt class="docutils literal"><span class="pre">subplot</span></tt> has three arguments.  The first specifies the number of rows that the figure space is to be divided into; on line 13, it&#8217;s two.  The second specifies the number of columns that the figure space is to be divided into;  on line 13, it&#8217;s one.  The third argument specifies which rectangle the will contain the plot specified by the following function calls.  Line 13 specifies that the plotting commands that follow will be act on the first box.  Line 24 specifies that the plotting commands that follow will be act on the second box.</p>
<p>We have also labeled the axes and included dashed vertical lines at the values of <img class="math" src="../_images/math/a9cfbeb8ebee1f365919e147a79e242dcb67ee5d.png" alt="\theta"/> where <img class="math" src="../_images/math/03317095d80476c4ecca47a9004927ed8672e7a7.png" alt="\tan\theta"/> and <img class="math" src="../_images/math/d7f0a662f0514815599f1d64af426699da78a1d7.png" alt="\cot\theta"/> diverge.</p>
</div>
</div>
<div class="section" id="logarithmic-plots">
<h2>5.3. Logarithmic plots<a class="headerlink" href="#logarithmic-plots" title="Permalink to this headline">¶</a></h2>
<p id="index-9">Data sets can span many orders of magnitude from fractional quantities much smaller than unity to values much larger than unity.  In such cases it is often useful to plot the data on logarithmic axes.</p>
<div class="section" id="semi-log-plots">
<h3>5.3.1. Semi-log plots<a class="headerlink" href="#semi-log-plots" title="Permalink to this headline">¶</a></h3>
<p id="index-10">For data sets that vary exponentially in the independent variable, it is often useful to use one or more logarithmic axes.  Radioactive decay of unstable nuclei, for example, exhibits an exponential decrease in the number of particles emitted from the nuclei as a function of time.  In the plot below, for example, we show the decay of the radioactive isotope Phosphorus-32 over a period of 6 months, where the radioactivity is measured once each week.  Starting at a decay rate of nearly <img class="math" src="../_images/math/7df15fdc7d219c3dda864ea8d3b902e059847459.png" alt="10^4"/> electrons (counts) per second, the decay rate diminishes to only about 1 count per second after about 6 months or 180 days.  If we plot counts per second as a function of time on a normal plot, as we have done in the plot on the left below, then the count rate is indistinguishable from zero after about 100 days.  On the other hand, if we use a logarithmic axis for the count rate, as we have done in the plot on the right below, then we can follow the count rate well past 100 days and can readily distinguish it from zero.  Moreover, if the data vary exponentially in time, then the data will fall along a straight line, as they do for the case of radioactive decay.</p>
<div class="figure align-center" id="fig-semilogdemo">
<a class="reference internal image-reference" href="../_images/semilogDemo.png"><img alt="Semi-log plotting" src="../_images/semilogDemo.png" style="width: 800.0px; height: 320.0px;" /></a>
<p class="caption">Semi-log plotting</p>
</div>
<p>MatPlotLib provides two functions for making semi-logarithmic plots, <tt class="docutils literal"><span class="pre">semilogx</span></tt> and <tt class="docutils literal"><span class="pre">semilogy</span></tt>, for creating plots with logarithmic <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> and <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> axes, with linear <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> and <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> axes, respectively.  We illustrate their use in the program below, which made the above plots.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="c"># read data from file</span>
<span class="n">time</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="n">unc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s">&#39;SemilogDemo.txt&#39;</span><span class="p">,</span> <span class="n">unpack</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c"># create theoretical fitting curve</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mf">20.2</span>      <span class="c"># Phosphorus-32 half life = 14 days; tau = t_half/ln(2)</span>
<span class="n">N0</span> <span class="o">=</span> <span class="mf">8200.</span>       <span class="c"># Initial count rate (per second)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">N0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="o">/</span><span class="n">tau</span><span class="p">)</span>

<span class="c"># create plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;theory&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="s">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;time (days)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;counts per second&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;upper right&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="s">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;theory&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">counts</span><span class="p">,</span> <span class="s">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&quot;data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;time (days)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;counts per second&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s">&#39;upper right&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c"># display plot on screen</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>The <tt class="docutils literal"><span class="pre">semilogx</span></tt> and <tt class="docutils literal"><span class="pre">semilogy</span></tt> functions work the same way as the <tt class="docutils literal"><span class="pre">plot</span></tt> function.  You just use one or the other depending on which axis you want to be logarithmic.</p>
<div class="section" id="the-tight-layout-function">
<h4>5.3.1.1. The <tt class="docutils literal"><span class="pre">tight_layout()</span></tt> function<a class="headerlink" href="#the-tight-layout-function" title="Permalink to this headline">¶</a></h4>
<p id="index-11">You may have noticed the <tt class="docutils literal"><span class="pre">tight_layout()</span></tt> function, called without arguments on line 30 of the program.  This is a convenience function that adjusts the sizes of the plots to make room for the axes labels.  If it is not called, the <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/>-axis label of the right plot runs into the left plot.  The <tt class="docutils literal"><span class="pre">tight_layout()</span></tt> function can also be useful in graphics windows with only one plot sometimes.</p>
</div>
</div>
<div class="section" id="log-log-plots">
<h3>5.3.2. Log-log plots<a class="headerlink" href="#log-log-plots" title="Permalink to this headline">¶</a></h3>
<p id="index-12">MatPlotLib can also make log-log or double-logarithmic plots using the function <tt class="docutils literal"><span class="pre">loglog</span></tt>.  It is useful when both the <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> and <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> data span many orders of magnitude.  Data that are described by a power law <img class="math" src="../_images/math/7ccdc1a9bf78d17463375b789e0c4c44c3f79d27.png" alt="y=Ax^b"/>, where <img class="math" src="../_images/math/0acafa529182e79b4f56165ec677554fba7fcf98.png" alt="A"/> and <img class="math" src="../_images/math/5e87bf41a96deddf6cb485ff530f153f2590e9cc.png" alt="b"/> are constants, appear as straight lines when plotted on a log-log plot.  Again, the <tt class="docutils literal"><span class="pre">loglog</span></tt> function works just like the <tt class="docutils literal"><span class="pre">plot</span></tt> function but with logarithmic axes.</p>
</div>
</div>
<div class="section" id="more-advanced-graphical-output">
<h2>5.4. More advanced graphical output<a class="headerlink" href="#more-advanced-graphical-output" title="Permalink to this headline">¶</a></h2>
<p>The plotting methods introduced in the previous sections are perfectly adequate for basic plotting and are therefore recommended for simple graphical output.  Here, we introduce an alternative syntax that harnesses the full power of MatPlotLib.  It gives the user more options and greater control.  Perhaps the most efficient way to learn this alternative syntax is to look at an example.  The figure below illustrating <a class="reference internal" href="#multplotdemo"><em>Mulitple plots in the same window</em></a> is produced by the following code:</p>
<div class="figure align-center" id="multplotdemo">
<a class="reference internal image-reference" href="../_images/MultPlotDemo.png"><img alt="Mulitple plots in the same window" src="../_images/MultPlotDemo.png" style="width: 320.0px; height: 284.0px;" /></a>
<p class="caption">Mulitple plots in the same window</p>
</div>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre></div></td><td class="code"><div class="highlight"><pre><span class="c"># Demonstrates the following:</span>
<span class="c">#     plotting logarithmic axes</span>
<span class="c">#     user-defined functions</span>
<span class="c">#     &quot;where&quot; function, NumPy array conditional</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="c"># Define the sinc function, with output for x=0 defined</span>
<span class="c"># as a special case to avoid division by zero. The code</span>
<span class="c"># below defining the sinc function is developed and</span>
<span class="c"># explained in Chapter 7, Section 1.</span>
<span class="k">def</span> <span class="nf">s</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span><span class="o">==</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">a</span>

<span class="c"># create arrays for plotting</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>

<span class="c"># create a figure window</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="c"># subplot: linear plot of exponential</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;time (ms)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;distance (mm)&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;exponential&#39;</span><span class="p">)</span>

<span class="c"># subplot: semi-log plot of exponential</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;time (ms)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;distance (mm)&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;exponential&#39;</span><span class="p">)</span>

<span class="c"># subplot: wide subplot of sinc function</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;angle (deg)&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;electric field&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">&#39;sinc function&#39;</span><span class="p">)</span>

<span class="c"># Adjusts white space to avoid collisions between subplots</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>After defining several arrays for plotting, the above program opens a figure window in line 23 with the statement</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</pre></div>
</div>
<p>The MatPlotLib statement above creates a <strong>Figure</strong> object, assigns it the name <tt class="docutils literal"><span class="pre">fig</span></tt>, and opens a blank figure window.  Thus, just as we give lists, arrays, and numbers variable names (<em>e.g.</em> <tt class="docutils literal"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">5,</span> <span class="pre">7]</span></tt>, <tt class="docutils literal"><span class="pre">dd</span> <span class="pre">=</span> <span class="pre">np.array([2.3,</span> <span class="pre">5.1,</span> <span class="pre">3.9])</span></tt>, or <tt class="docutils literal"><span class="pre">st</span> <span class="pre">=</span> <span class="pre">4.3</span></tt>), we can give a figure object and the window in creates a name: here it is <tt class="docutils literal"><span class="pre">fig</span></tt>.  In fact we can use the <tt class="docutils literal"><span class="pre">figure</span></tt> function to open up multiple figure objects with different figure windows.  The statements</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">fig1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
</pre></div>
</div>
<p>open up two separate windows, one named <tt class="docutils literal"><span class="pre">fig1</span></tt> and the other <tt class="docutils literal"><span class="pre">fig2</span></tt>.  We can then use the names <tt class="docutils literal"><span class="pre">fig1</span></tt> and <tt class="docutils literal"><span class="pre">fig2</span></tt> to plot things in either window.  The <tt class="docutils literal"><span class="pre">figure</span></tt> function need not take any arguments if you are satisfied with the default settings such as the figure size and the background color.  On the other hane, by supplying one or more keyword arguments, you can customize the figure size, the background color, and a few other properties.  For example, in the program listing (line 23), the keyword argument <tt class="docutils literal"><span class="pre">figsize</span></tt> sets the width and height of the figure window; the default size is <tt class="docutils literal"><span class="pre">(8,</span> <span class="pre">6)</span></tt>; in our program we set it to <tt class="docutils literal"><span class="pre">(9,</span> <span class="pre">8)</span></tt>, which is a bit wider and higher than the default size.  In the example above, we also choose to open only a single window, hence the single <tt class="docutils literal"><span class="pre">figure</span></tt> call.</p>
<p>The <tt class="docutils literal"><span class="pre">fig.add_subplot(2,2,1)</span></tt> in line 30 is a MatPlotLib function that divides the figure window into 2 rows (the first argument) and 2 columns (the second argument).  The third argument creates a subplot in the first of the 4 subregions (<em>i.e.</em> of the 2 rows <img class="math" src="../_images/math/c69691d64985442217922c8d34e835a9dea60178.png" alt="\times"/> 2 columns) created by the <tt class="docutils literal"><span class="pre">fig.add_subplot(2,2,1)</span></tt> call.   To see how this works, type the following code into a Python module and run it:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>You should get a figure window with axes drawn in the upper left quadrant.  The <tt class="docutils literal"><span class="pre">fig.</span></tt> prefix used with the <tt class="docutils literal"><span class="pre">add_subplot(2,2,1)</span></tt> function directs Python to draw these axes in the figure window named <tt class="docutils literal"><span class="pre">fig</span></tt>.  If we had opened two figure windows, changing the prefix to correspond to the name of one or the other of the figure windows would direct the axes to be drawn in the appropriate window.  Writing <tt class="docutils literal"><span class="pre">ax1</span> <span class="pre">=</span> <span class="pre">fig.add_subplot(2,2,1)</span></tt> assigns the name ax1 to the axes in the upper left quadrant of the figure window.</p>
<p>The <tt class="docutils literal"><span class="pre">ax1.plot(x,</span> <span class="pre">y)</span></tt> in line 27 directs Python to plot the previously-defined <tt class="docutils literal"><span class="pre">x</span></tt> and <tt class="docutils literal"><span class="pre">y</span></tt> arrays onto the axes named <tt class="docutils literal"><span class="pre">ax1</span></tt>. The <tt class="docutils literal"><span class="pre">ax2</span> <span class="pre">=</span> <span class="pre">fig.add_subplot(2,2,2)</span></tt> draws axes in the second, or upper right, quadrant of the figure window. The <tt class="docutils literal"><span class="pre">ax3</span> <span class="pre">=</span> <span class="pre">fig.add_subplot(2,1,2)</span></tt> divides the figure window into 2 rows (first argument) and 1 column (second argument), creates axes in the second or these two sections, and assigns those axes (<em>i.e.</em> that subplot) the name <tt class="docutils literal"><span class="pre">ax3</span></tt>.  That is, it divides the figure window into 2 halves, top and bottom, and then draws axes in the half number 2 (the third argument), or lower half of the figure window.</p>
<p>You may have noticed in above code that some of the function calls are a bit different from those used before: <tt class="docutils literal"><span class="pre">xlabel(’time</span> <span class="pre">(ms)’)</span></tt> becomes <tt class="docutils literal"><span class="pre">set_xlabel(’time</span> <span class="pre">(ms)’)</span></tt>, <tt class="docutils literal"><span class="pre">title(’exponential’)</span></tt> becomes <tt class="docutils literal"><span class="pre">set_title(’exponential’)</span></tt>, <em>etc.</em></p>
<p>The call <tt class="docutils literal"><span class="pre">ax2.set_yscale('log')</span></tt> sets the <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/>-axes in the second plot to be logarithmic, thus creating a semi-log plot.  Creating properly-labeled logarthmic axes like this is more straightforward with the advanced syntax illustrated in the above example.</p>
<p>Using the prefixes <tt class="docutils literal"><span class="pre">ax1</span></tt>, <tt class="docutils literal"><span class="pre">ax2</span></tt>, or <tt class="docutils literal"><span class="pre">ax3</span></tt>, direct graphical instructions to their respective subplots.  By creating and specifying names for the different figure windows and subplots within them, you access the different plot windows more efficiently.  For example, the following code makes four identical subplots in a single figure window using a <tt class="docutils literal"><span class="pre">for</span></tt> loop.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span><span class="p">()</span>

<span class="gp">In [2]: </span><span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>

<span class="gp">In [4]: </span><span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">ax4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>

<span class="gp">In [6]: </span><span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">]:</span>
<span class="gp">   ...:</span>     <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">],[</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="gp">In [7]: </span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="exercises">
<h2>5.5. Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Plot the function <img class="math" src="../_images/math/a88b4d9e8b9717e6e1584b12384ad77e7e751ab7.png" alt="y=3x^2"/> for <img class="math" src="../_images/math/9390ece3a47e96ac26d11993307d408df8d9025d.png" alt="-1 \le x \le 3"/> as a continuous line.  Include enough points so that the curve you plot appears smooth.  Label the axes <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> and <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/>.</p>
</li>
<li><p class="first">Plot the following function for <img class="math" src="../_images/math/1835e026ca5010f235132df197ddde0c3773f50e.png" alt="-15 \le x \le 15"/>:</p>
<div class="math">
<p><img src="../_images/math/f9b5f9579bf532e87f26aea8feb5faabc15580f1.png" alt="y = \frac{\cos x}{1+\frac{1}{5}x^2}"/></p>
</div><p>Include enough points so that the curve you plot appears smooth.  Label the axes <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> and <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/>.</p>
</li>
<li><p class="first">Plot the functions <img class="math" src="../_images/math/ea11ea4668cdde45adf176f2ba2979e05f21a1e0.png" alt="\sin x"/> and <img class="math" src="../_images/math/1c368ed9a99ac8bff9855713aa73c344c2fcf35a.png" alt="\cos x"/> <em>vs</em> <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> on the same plot with <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> going from <img class="math" src="../_images/math/3723ed53ca6fd37b4ba725f84af223bb8a0c3966.png" alt="-\pi"/> to <img class="math" src="../_images/math/c1bd4cb4e3647c6b2356b7ccf2f52aeffedd1b61.png" alt="\pi"/>.  Make sure the limits of <img class="math" src="../_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/>-axis do not extend beyond the limits of the data.  Plot <img class="math" src="../_images/math/ea11ea4668cdde45adf176f2ba2979e05f21a1e0.png" alt="\sin x"/> in the color green and <img class="math" src="../_images/math/1c368ed9a99ac8bff9855713aa73c344c2fcf35a.png" alt="\cos x"/> in the color black and include a legend to label the two curves.  Place the legend within the plot, but such that it does not cover either of the sine or cosine traces.</p>
</li>
<li><p class="first">Create a data file with the data shown below.</p>
<ol class="loweralpha">
<li><p class="first">Read the data into Python program and plot <img class="math" src="../_images/math/ef9270877405055756d345facd044e4ab297f858.png" alt="t"/> <em>vs</em> <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> using circles for data points with error bars.  Use the data in the <tt class="docutils literal"><span class="pre">dy</span></tt> column as the error estimates for the <img class="math" src="../_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> data.  Label the horizontal and vertical axes &#8220;time (s)&#8221; and &#8220;position (cm)&#8221;.</p>
</li>
<li><p class="first">On the same graph, plot the function below as a smooth line.  Make the line pass <em>behind</em> the data points.</p>
<div class="math">
<p><img src="../_images/math/e8023a65e6792b0475b2c3edf66e437398f2af28.png" alt="y(t) = \left[3 +
       \frac{1}{2}\sin\frac{\pi t}{5}\right]
       t\, e^{-t/10}"/></p>
</div><div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre>Data for Exercise 4
Date: 16-Aug-2013
Data taken by Lauren and John

 t      d       dy
 1.0    2.94    0.7
 4.5    8.29    1.2
 8.0    9.36    1.2
11.5   11.60    1.4
15.0    9.32    1.3
18.5    7.75    1.1
22.0    8.06    1.2
25.5    5.60    1.0
29.0    4.50    0.8
32.5    4.01    0.8
36.0    2.62    0.7
39.5    1.70    0.6
43.0    2.03    0.6
</pre></div>
</td></tr></table></div>
</li>
</ol>
</li>
<li><p class="first">Use MatPlotLib&#8217;s function <tt class="docutils literal"><span class="pre">hist</span></tt> along with NumPy&#8217;s function&#8217;s <tt class="docutils literal"><span class="pre">random.rand</span></tt> and <tt class="docutils literal"><span class="pre">random.randn</span></tt> to create the histogram graphs shown in Fig. <a class="reference internal" href="../chap3/chap3_arrays.html#fig-randhistos"><em>Histograms of random numbers.</em></a></p>
</li>
<li><p class="first">Plot force <em>vs</em> distance with error bars using the following data:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.38</span><span class="p">,</span> <span class="mf">0.64</span><span class="p">,</span> <span class="mf">0.91</span><span class="p">,</span> <span class="mf">1.26</span><span class="p">,</span> <span class="mf">1.41</span><span class="p">,</span> <span class="mf">1.66</span><span class="p">,</span> <span class="mf">1.90</span><span class="p">,</span> <span class="mf">2.18</span><span class="p">])</span>
<span class="n">f</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.65</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">3.95</span><span class="p">,</span> <span class="mf">4.3</span><span class="p">,</span> <span class="mf">5.20</span><span class="p">,</span> <span class="mf">6.85</span><span class="p">,</span> <span class="mf">7.4</span><span class="p">])</span>
<span class="n">df</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>
</pre></div>
</div>
<p>Your plot should also include a visual straight &#8220;best fit&#8221; to the data as well as visual &#8220;fits&#8221; that give the smallest and largest slopes consistent with the data.  Note, you only need two points to define a straight line so the straight lines you draw on the plot should be arrays of length 2 and no longer.  All of your fitted lines should lie <em>behind</em> the data.  Try to make your plot look like the one below.  <em>In addition</em>, add a legend to your plot the gives the slope with its uncertainty obtained from your visual fits to the data.</p>
<div class="figure align-center" id="fig-lineardata">
<a class="reference internal image-reference" href="../_images/LinearData.png"><img alt="../_images/LinearData.png" src="../_images/LinearData.png" style="width: 480.0px; height: 320.0px;" /></a>
</div>
<p>The web page <a class="reference external" href="http://matplotlib.org/api/pyplot_summary.html">http://matplotlib.org/api/pyplot_summary.html</a> gives a summary of the main plotting commands available in MatPlotLib.  The two important ones here are <tt class="docutils literal"><span class="pre">plot</span></tt> and <tt class="docutils literal"><span class="pre">errorbar</span></tt>, which make regular plots and plots with error bars, respectively.  You will find the following keyword arguments useful: <tt class="docutils literal"><span class="pre">yerr</span></tt>, <tt class="docutils literal"><span class="pre">ls</span></tt>, <tt class="docutils literal"><span class="pre">marker</span></tt>, <tt class="docutils literal"><span class="pre">mfc</span></tt>, <tt class="docutils literal"><span class="pre">mec</span></tt>, <tt class="docutils literal"><span class="pre">ms</span></tt>, and <tt class="docutils literal"><span class="pre">ecolor</span></tt>, which you can find described by clicking on the <tt class="docutils literal"><span class="pre">errorbar</span></tt> function link on the web page cited above.</p>
</li>
<li><p class="first">The data file below shows data obtained for the displacement (position) <em>vs</em> time of a falling object, together with the estimated uncertainty in the displacement.</p>
<blockquote>
<div><div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25</pre></div></td><td class="code"><div class="highlight"><pre>Measurements of fall velocity vs time
Taken by A.P. Crawford and S.M. Torres
19-Sep-13
time (s)    position (m)    uncertainty (m)
 0.0            0.0             0.04
 0.5            1.3             0.12
 1.0            5.1             0.2
 1.5           10.9             0.3
 2.0           18.9             0.4
 2.5           28.7             0.4
 3.0           40.3             0.5
 3.5           53.1             0.6
 4.0           67.5             0.6
 4.5           82.3             0.6
 5.0           97.6             0.7
 5.5          113.8             0.7
 6.0          131.2             0.7
 6.5          148.5             0.7
 7.0          166.2             0.7
 7.5          184.2             0.7
 8.0          201.6             0.7
 8.5          220.1             0.7
 9.0          238.3             0.7
 9.5          256.5             0.7
10.0          275.6             0.8
</pre></div>
</td></tr></table></div>
</div></blockquote>
<ol class="loweralpha simple">
<li>Use these data to calculate the velocity and acceleration (in a Python program <tt class="docutils literal"><span class="pre">.py</span></tt> file), together with their uncertainties propagated from the displacement <em>vs</em> time uncertainties.  Be sure to calculate time arrays corresponding the midpoint in time between the two displacements or velocities for the velocity and acceleration arrays, respectively.</li>
<li>In a single window frame, make three vertically stacked plots of the displacement, velocity, and acceleration <em>vs</em> time.  Show the error bars on the different plots.  Make sure that the time axes of all three plots cover the same range of times. Why do the relative sizes of the error bars grow progressively greater as one progresses from displacement to velocity to acceleration?</li>
</ol>
</li>
</ol>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../chap1/chap1_intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap2/chap2_basics.html">2. Launching Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap3/chap3_arrays.html">3. Strings, Lists, Arrays, and Dictionaries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap4/chap4_io.html">4. Input and Output</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">5. Plotting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#an-interactive-session-with-pyplot">5.1. An interactive session with <tt class="docutils literal"><span class="pre">pyplot</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="#basic-plotting">5.2. Basic plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#logarithmic-plots">5.3. Logarithmic plots</a></li>
<li class="toctree-l2"><a class="reference internal" href="#more-advanced-graphical-output">5.4. More advanced graphical output</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exercises">5.5. Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../chap6/chap6_loopsconds.html">6. Conditionals and Loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap7/chap7_funcs.html">7. Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap8/chap8_fitting.html">8. Curve Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../chap9/chap9_scipy.html">9. Numerical Routines: SciPy and NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apdx1/apdx1_install.html">10. Installing Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apdx2/apdx2_ipynb.html">11. IPython Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apdx3/apdx3_resources.html">12. Python Resources</a></li>
</ul>

          <h3 style="margin-top: 1.5em;">Search</h3>
          <form class="search" action="../search.html" method="get">
            <input type="text" name="q" />
            <input type="submit" value="Go" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
          <p class="searchtip" style="font-size: 90%">
            Enter search terms or a module, class or function name.
          </p>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <a href="../chap4/chap4_io.html" title="4. Input and Output"
             >previous</a> |
          <a href="../chap6/chap6_loopsconds.html" title="6. Conditionals and Loops"
             >next</a> |
          <a href="../genindex.html" title="General Index"
             >index</a>
            <br/>
            <a href="../_sources/chap5/chap5_plot.txt"
               rel="nofollow">Show Source</a>
        </div>

        <div class="right">
          
    <div class="footer">
        &copy; Copyright 2014, David J. Pine.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>